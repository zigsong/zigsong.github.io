<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Docker로 MySQL 띄워 NestJS + TypeORM과 연결하기 - zig-log</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="zig-log"><meta name="msapplication-TileImage" content="/images/balloon-favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="zig-log"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="투머치 제목"><meta property="og:type" content="blog"><meta property="og:title" content="Docker로 MySQL 띄워 NestJS + TypeORM과 연결하기"><meta property="og:url" content="https://zigsong.github.io/2022/05/12/nest-typeorm/"><meta property="og:site_name" content="zig-log"><meta property="og:description" content="투머치 제목"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://zigsong.github.io/images/nest-thumbnail.png"><meta property="article:published_time" content="2022-05-12T11:50:49.000Z"><meta property="article:modified_time" content="2022-05-14T03:54:45.547Z"><meta property="article:author" content="jieun song"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/nest-thumbnail.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://zigsong.github.io/2022/05/12/nest-typeorm/"},"headline":"Docker로 MySQL 띄워 NestJS + TypeORM과 연결하기","image":["https://zigsong.github.io/images/nest-thumbnail.png"],"datePublished":"2022-05-12T11:50:49.000Z","dateModified":"2022-05-14T03:54:45.547Z","author":{"@type":"Person","name":"jieun song"},"description":"투머치 제목"}</script><link rel="canonical" href="https://zigsong.github.io/2022/05/12/nest-typeorm/"><link rel="icon" href="/images/balloon-favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">ZIG-LOG</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/zigsong"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-05-12T11:50:49.000Z" title="2022. 5. 12. 오후 8:50:49">2022-05-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-05-14T03:54:45.547Z" title="2022. 5. 14. 오후 12:54:45">2022-05-14</time></span><span class="level-item"><a class="link-muted" href="/categories/nestjs/">nestjs</a></span><span class="level-item">36 minutes read (About 5371 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Docker로 MySQL 띄워 NestJS + TypeORM과 연결하기</h1><div class="content"><h3 id="투머치-제목"><a href="#투머치-제목" class="headerlink" title="투머치 제목"></a>투머치 제목</h3><img class="preview" src="/images/nest-thumbnail.png">

<span id="more"></span>

<br />
<br />

<hr>
<p>이 얼마나 거창한 제목인가…</p>
<hr>
<p>사내 웹프론트그룹에서 하고 있는 어떠한 비밀(?..) 프로젝트에서, 막내라는 이유로 그룹장을 하고 있당. 최종적으로 만들고 싶은 플랫폼의 프로토타이핑을 하고, 각자의 꿈을 펼쳐보기로…</p>
<img src="/images/article/nest-typeorm/d_1.png" />
<br />

<p>그렇게 무모하게 Nest.js가 뭔지도 잘 모른채, 그저 fancy하다는 이유로 첫 삽을 파보았다.</p>
<hr>
<h2 id="NestJS"><a href="#NestJS" class="headerlink" title="NestJS"></a>NestJS</h2><blockquote>
<p>Nest (NestJS) is a framework for building efficient, scalable <strong><a target="_blank" rel="noopener" href="https://nodejs.org/">Node.js</a></strong>  server-side applications</p>
</blockquote>
<p>라고 한다. 효율적이고, 확장 가능한 Node.js 기반의 서버사이드 앱을 만들기 위한 프레임워크다. 뭐든 자기 앱이 제일 개쩌니까~! 딱히 웅장하진 않은 재미없고 딱딱한 소개를 하고 있다. </p>
<p>조금 trendy하다고 느낀 건, 기본으로 TypeScript를 지원한다는 사실이다. 아아… 타입스크립트 없이는 살지 못해… </p>
<p>이 NestJS의 구조는 크게 <strong>Controller</strong>, <strong>Provider</strong>, <strong>Module</strong>로 나뉜다.</p>
<p>✔️ <strong>Controller</strong></p>
<p>클라이언트에서 들어오는 요청을 처리하고 응답을 반환하는 역할을 수행한다. 나는 TechStack을 만들고 싶으므로 아래와 같이 야심차게 시작해본다.  </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tech-stacks.controller.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Controller, Get &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Controller(<span class="string">&#x27;tech-stacks&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TechStacksController</span> </span>&#123;</span><br><span class="line">  @Get()</span><br><span class="line">  findAll(): string &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, techStacks&#x27;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>컨트롤러는 엔드포인트 라우팅(routing) 메커니즘을 통해 각 컨트롤러가 받을 수 있는 요청을 분류한다. 그래서 컨트롤러를 사용 목적에 따라 잘 구분하면 구조적이고 모듈화된 소프트웨어를 작성할 수 있다고 한다.</p>
<p>직접 컨트롤러 파일을 만들지 않고도 아래 명령어로 fancy하게 자동으로 파일을 만들 수 있다. MZ세대 취향저격</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nest g controller [name]</span><br></pre></td></tr></table></figure>

<p>난 분명 <code>techStacks</code> 로 CLI를 돌렸는데 자동으로 <code>tech-stacks</code> 이름으로 파일이 생성됐다. 저기 컨벤션인가보다. </p>
<p>컨트롤러만 단독으로 만드는 대신 CRUD 보일러플레이트 코드를 한번에 생성할 수도 있다고 한다. 아아… 이 얼마나 멋진…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nest g resource [name]</span><br></pre></td></tr></table></figure>
<img src="/images/article/nest-typeorm/d_2.png" width="360px" />
<br />

<p>✔️ <strong>Provider</strong></p>
<p>Nest의 핵심 개념으로, 여러 소스들로 프로바이더를 구현할 수 있다. 이를테면 service, repository, factory, helper, 등등… (하나만 해라 제발) </p>
<p>프로바이더는 의존성으로 주입될 수 있는 데이터 가공 함수들을 모아둔 객체다. 수없이 되뇌었던 그 이름..! IoC! 의존성을 이렇게 분리하다니. 역시 fancy한 프레임워크다. 사실 다른 프레임워크에서는 어떻게 하고 있는지 잘 모른다. </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tech-stacks.service.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStack &#125; <span class="keyword">from</span> <span class="string">&#x27;./interfaces/techStack.interface&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Injectable()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TechStacksService</span> </span>&#123;</span><br><span class="line">  private readonly techStacks: TechStack[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">create</span>(<span class="params">techStacks: TechStack</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.techStacks.push(TechStack);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  findAll(): TechStack[] &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.techStacks;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>앱이 제공하고자 하는 핵심 기능, 즉 비즈니스 로직을 수행하는 역할을 하는 것이 프로바이더이다. 컨트롤러가 이 역할을 수행할 수도 있겠지만 소프트웨어 구조상 분리해 두는 것이 단일 책임 원칙(SRP, Single Responsibility Principle)에 더 부합하기 때문이라고 한다. IoC, SRP 이런 말 써줘야 또 있어보인다.</p>
<p>✔️ <strong>Module</strong></p>
<p>일반적으로 모듈이라고 하면 조그만 클래스나 함수처럼 한가지 일만 수행하는 소프트웨어 컴포넌트가 아니라, 여러 컴포넌트를 조합하여 작성한 좀 더 큰 작업을 수행하는 단위를 말한다.</p>
<p>Nest에서 모듈은 앱의 구조 설계를 위한 metadata를 제공한다. metadata라고만 말하고 있으니 도통 무슨 소린지 알 수가 없다. 그냥 앱의 루트 모듈이 있고, 하위에 도메인별로 모듈을 나눴다고 생각하면 될 듯하다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Module &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStacksController &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks/tech-stacks.controller&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppController &#125; <span class="keyword">from</span> <span class="string">&#x27;./app.controller&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppService &#125; <span class="keyword">from</span> <span class="string">&#x27;./app.service&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStacksService &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks/tech-stacks.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Module(&#123;</span><br><span class="line">  imports: [],</span><br><span class="line">  controllers: [AppController, TechStacksController],</span><br><span class="line">  providers: [AppService, TechStacksService],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>귀차나서 Nest가 기본으로 만들어준 <code>app.module</code> 파일에 <code>TechStack</code> 도메인의 아이들도 같이 욱여넣어줬다.</p>
<p><code>yarn</code> 으로 로컬 서버를 실행하고 3000번 포트로 접속하면, <code>Hello, techStacks</code> 텍스트가 썰렁하게 등장한다! (포스팅을 쓰는 지금 시점에서는 코드가 많이 바뀐 상태이므로 그냥 그랬을 것이라고 이해하자.) </p>
<p>그렇게 별 문제없이 아주 야심차게 시작하는 듯 했으나..!</p>
<p>TypeORM을 연결하려면 실제 DB가 있어야 한다..! MongoDB도 잠깐 해봤고, MySQL도 해보긴 했다. 프로토타이핑을 하는 가벼운(?) 단계에서 선택 기준은 그저 ‘소스가 얼마나 많은가’. 역시 MySQL로 ㄱㄱ</p>
<p>그렇게 Nest에 MySQL을 등에 업은 TypeORM 연결을 위해 검색에 나섰는데, 아마 첫 번째 검색 결과가 화근이었을까. docker로 하고 있는 게 아니겠는가..! 분명 모두가 docker를 사용하고 있는 것 같았는데, 지금 다시 검색해보니 꼭 그렇지만은 않은 것 같다.</p>
<p>하지만… 며칠 전의 나는 docker를 꼭 해야한다고 생각했고… 그렇게 TypeORM, MySQL을 뒤로 한 채 docker로 가보았다. -이제 꼬리물기 끝-</p>
<hr>
<h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><p>도커는 컨테이너 기반의 오픈소스 가상화 플랫폼이다. 컨테이너 안에는 다양한 프로그램, 실행 환경을 ‘컨테이너’라는 개념으로 추상화하고 클라우드, PC 등 어디서든 실행할 수 있다.</p>
<p>자세한 설명이나 등장 배경은 이미 다른 검색 결과에 많으니 생략한다.</p>
<p>도커 설치부터 애를 먹었다.</p>
<p>도커를 자동으로 설치해주는 아래 커맨드</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -qO- https://get.docker.com/ | sh</span><br></pre></td></tr></table></figure>

<p>를 입력하면 <code>wget: command not found</code> 에러가 뜨고, 그래서 <code>wget</code>을 설치해주려고 하면 <code>yum</code>을 사용하란다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install wget</span><br></pre></td></tr></table></figure>

<p>커맨드를 입력하면 <code>yum: command not found</code> </p>
<p>잠시 숨을 고르고 <code>yum</code>도 설치하라는 대로 해준다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install yum</span><br></pre></td></tr></table></figure>

<p>결과는</p>
<p><code>apt-get: command not found</code></p>
<img src="/images/article/nest-typeorm/d_3.png" />
<br />

<p>(아마도) <code>homebrew</code>로 간신히 도커를 설치하고, mysql 실행을 위해 mysql image를 pull해준다. 아니?! 이게 대체 무슨 소리냐</p>
<ul>
<li><strong>docker hub(registry)</strong>: 앱스토어 역할이다. 필요한 프로그램을 다운로드받을 수 있는 곳이다. (마치 npm에 여러 패키지가 등록되어 있고, 개발자가 필요한 패키지를 <code>npm install</code>로 설치하는 것과 같다.)</li>
<li><strong>image</strong>: docker hub의 프로그램(ex. apache, mysql)을 컴퓨터에 다운로드받은 것이다.</li>
<li><strong>container</strong>: 다운받은 image를 실행하는 것이다. image는 여러 개의 container를 가질 수 있다.</li>
</ul>
<p>docker hub에서 image를 다운 받는 과정을 <code>pull</code>, <code>image</code>를 실행시키는 행위를 <code>run</code> 이라고 한다. <a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a>에서 원하는 이미지를 다운로드받을 수 있다. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql </span><br></pre></td></tr></table></figure>

<p>다운로드 받은 image를 확인하려면 아래 명령어를 입력한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<img src="/images/article/nest-typeorm/d_4.png" />
<br />

<p>mysql이 잘 받아진 것 같다 <em>^^</em></p>
<p>어느 단계에서인지 까먹었으나, 아래와 같은 에러가 뜨는 경우가 있다. </p>
<blockquote>
<p>🚨 no matching manifest for linux/arm64/v8 in the manifest list entries </p>
</blockquote>
<p>회사에서 준 최고 빠른 M1 Mac은 정말 사랑스럽고 손이 많이 가는 친구다. 뭐 하나 설치하려 해도 낯선 에러가 떠서 검색해보면, M1 칩 이슈라고 한다^^…</p>
<p>에러 메시지를 검색해서 나온 블로그가 작년에 우테코를 같이 했던 <a target="_blank" rel="noopener" href="https://unluckyjung.github.io/develop-setting/2021/03/27/M1-Docker-Mysql-Error/">백엔드 크루(지만 서로 모르는…)의 글</a>이었다. </p>
<p><code>docker-compose.yml</code> 파일을 만들어 다음과 같이 작성해준다.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">local-db:</span></span><br><span class="line">    <span class="attr">platform:</span> <span class="string">linux/x86_64</span> <span class="comment"># m1 mac 이슈</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">library/mysql:5.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">local-db</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3306</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">secret</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Seoul</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./db/mysql/data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./db/mysql/init:/docker-entrypoint-initdb.</span></span><br></pre></td></tr></table></figure>

<p>그리고 <code>compose</code> 명령어를 입력해준다</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<p>이제 mysql 컨테이너를 만들어준다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name [container name] -e MYSQL_ROOT_PASSWORD=&lt;password&gt; -d -p 3306:3306 mysql</span><br></pre></td></tr></table></figure>

<p><code>3306:3306</code>은, 각각 host의 포트와 container의 포트를 가리킨다. host의 3306번 포트와 docker container의 3306번 포트를 연결하라는 의미다. 처음에 무지성으로 쓰다가, 위대하신 이고잉 선생님의 강의를 듣고 이해 완.</p>
<p align="center">
<img src="/images/article/nest-typeorm/d_5.png" />
<i>(영광스러운 캡쳐도 떠 두었다.)</i>
</p>
<br />

<p>이를 port forwarding이라고 한다. <del>포워딩 별거 없네</del></p>
<p>그런데 계속 아래와 같은 에러가 뜨는 게 아니겠어..</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">🚨 Ports are not available: listen tcp 0.0.0.0:3306: <span class="built_in">bind</span>: address already <span class="keyword">in</span> use</span><br></pre></td></tr></table></figure>

<p>이미 mysql용 3306번 포트를 차지하고 있는 프로세스를 찾아서 <code>sudo kill -9 [process_number]</code> 를 입력해줘도 계속해서 끈질기게 포트를 차지해버리는 누군가…</p>
<p>거의 반나절을 고민한 끝에 찾아냈다. </p>
<img src="/images/article/nest-typeorm/d_6.png" width="640px" />
<br />

<p>🤯🤯🤯</p>
<p>후… 도커의 개념을 제대로 이해하지 못한 채로 이상한 데서 헤매고 있었다.</p>
<p>로컬에서 돌아가고 있던 MySQL 서버를 꺼준 후 다시 실행하면, 짜잔!</p>
<p align="center">
<img src="/images/article/nest-typeorm/d_7.png" />
<i>(갑자기 나타난 docker desktop)</i>
</p>
<br />


<p>개발자를 안심시키는 초록불과 함께 mysql-local 이름으로 지정한 mysql container가 돌아가는 것을 볼 수 있다.</p>
<p><code>docker run</code> 명령어는, <code>docker create</code> + <code>docker start</code> + <code>docker attach</code> 명령을 합친 것이라고 한다. <code>create</code>와 <code>start</code> 는 알겠고, <code>attach</code>까지 알아보기엔 힘이 달렸다.</p>
<p>도커로 실행중인 프로세스를 보기 위해 <code>docker ps</code> 명령어를 입력한다. 아마 <code>process status</code>의 약자였던 것 같다. 진정한 별다줄의 세계는 프로그래밍 세계에서 탄생한 것이 아닐까, 생각한다.</p>
<p>현재 실행중인 프로세스 뿐 아니라 전체 프로세스를 확인하기 위해서는 <code>docker ps -a</code> 를 입력하면 된다. (<code>-a</code>는 누가 봐도 <code>all</code> 임을 짐작할 수 있다. 아님 말고)</p>
<img src="/images/article/nest-typeorm/d_8.png" />
<br />

<p>컨테이너가 하나밖에 없어서 썰렁하다. 새 컨테이너를 만들긴 귀찮으니 잠시 <code>mysql-local</code> 컨테이너를 꺼준 후 뭐가 나오는지 봐준다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop mysql-local</span><br></pre></td></tr></table></figure>

<img src="/images/article/nest-typeorm/d_9.png" />
<br />

<p>아까와는 달리 <code>STATUS</code>가 <code>Exited</code>로 표기된 것을 알 수 있다. 이제 보여주기식 실행이 끝났으니 다시 실행시킨다. <code>docker start mysql-local</code>을 하면 될 것 같았으나, 안 된다. 1년차 개발자의 짬을 믿고 <code>docker restart mysql-local</code> 을 입력해준다. 성공. ✌️</p>
<p>이제 이상한 짓은 그만두고 도커 실행 명령어를 입력한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it mysql-local bash</span><br></pre></td></tr></table></figure>

<p>아니, 아까는 <code>run</code> 하라며 갑자기 <code>exec</code>이 웬말이냐??</p>
<p><code>docker run</code>은 도커 컨테이너를 생성하고 실행까지 한번에 해주는 명령어다. </p>
<p>반면 <code>docker exec</code>는 실행중인 컨테이너에만 실행할 수 있는 명령어다. 일반적인 컨테이너 실행 명령어인 <code>run</code>과 달리 컨테이너 상태를 디버깅하기 위한 용도로 주로 사용한다. </p>
<p><code>docker exec</code>에는 주로 뒤에 여러 commands를 붙여서 실행한다. </p>
<p>ex) <code>docker exec mysql-test pwd</code></p>
<p>여기서는 bash에서 interactive shell을 열 목적으로 뒤에 <code>-it [container_name] bash</code> 옵션을 줄줄이 붙여줬다.</p>
<p>아무튼 그렇게 실행해준다.</p>
<img src="/images/article/nest-typeorm/d_10.png" />
<br />

<ul>
<li><code>-i</code> : interactive shell</li>
<li><code>-t</code>: terminal</li>
</ul>
<p>여기서 사용한 <code>-it</code> 는 <code>-i</code>와 <code>-t</code>를 합친 것으로, 터미널 입력을 위한 옵션을 뜻한다.</p>
<p>이밖에도 자주 사용되는 docker CLI option들은 다음과 같다.</p>
<table>
<thead>
<tr>
<th>옵션</th>
<th>설명</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>detached mode; 백그라운드 모드</td>
</tr>
<tr>
<td>-p</td>
<td>호스트와 컨테이너의 포트를 연결(포워딩)</td>
</tr>
<tr>
<td>-v</td>
<td>호스트와 컨테이너의 디렉토리를 연결(마운트)</td>
</tr>
<tr>
<td>-e</td>
<td>컨테이너 내에서 사용할 환경변수 설정</td>
</tr>
<tr>
<td>-name</td>
<td>컨테이너 이름 설정</td>
</tr>
<tr>
<td>-rm</td>
<td>프로세스 종료시 컨테이너 자동 제거</td>
</tr>
<tr>
<td>-link</td>
<td>컨테이너 연결 [컨테이너명:별칭]</td>
</tr>
</tbody></table>
<p>docker는 아무리 찾아봐도 이해가 되지 않았는데, <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Ps8HDIAyPD0&list=PLuHgQVnccGMDeMJsGq2O-55Ymtx0IdKWf">이고잉 선생님의 도커 입문 수업</a>을 듣고 갈증이 싹 가셨다.</p>
<img src="/images/article/nest-typeorm/d_11.png" />
<br />

<hr>
<h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><p>MySQL을 실행하려면 물론 MySQL을 다운받아야 한다. 그냥 <a target="_blank" rel="noopener" href="https://www.mysql.com/downloads/">공식 홈페이지</a>에서 직접 다운 받았다. </p>
<p>그리고 명령어 공부하기 귀찮아서 구이…구이(GUI)를 찾다가 <a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/workbench/">workbench</a>도 다운 받았다. (근데 딱히 편한 건 모르겠다^^ 이쁘지도 않다.) </p>
<p><code>docker exec</code>으로 실행한 shell에 아래 명령어를 입력하여 mysql 서버를 실행한다</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-u</code> <code>root</code> :</li>
<li><code>-p</code> : <code>p</code>는 <code>password</code>의 약자다. <code>-p [password]</code> 와 같은 식으로 바로 입력해줄 수도 있다. 패스워드를 생략하고 <code>-p</code> 만 사용하면 아래와 같은 패스워드 입력창이 뜬다.</li>
</ul>
<img src="/images/article/nest-typeorm/d_12.png" />
<br />

<p>패스워드까지 입력하면, ta-da! 🎉</p>
<img src="/images/article/nest-typeorm/d_13.png" />
<br />

<p>mysql 서버가 실행되었다. </p>
<p>그치만 난 쿼리를 해본지 오래됐으므로 workbench로 간다. </p>
<img src="/images/article/nest-typeorm/d_14.png" />
<br />

<p>UI는 정말 못생겼지만, 맥도날드 키오스크에서 헤매고 계실 우리 어머니 세대의 심정을 헤아려가며 찾다보면 어떻게든 테이블과 데이터를 만들 수 있다. 우여곡절을 거친 신입 개발자는 이제 뭘 클릭하는 데 거침없다. 우당탕탕 만들었기 때문에 어떻게 만들었는지 설명하진 못한다. </p>
<p>적당히 <code>techtree</code> 라는 이름의 테이블을 생성하고, <code>name</code>, <code>desc</code>, <code>image</code>, <code>url</code>, <code>type</code>, <code>id</code> 라는 필드(column이라고 해야될 듯 하다.)를 만들어주었다.</p>
<img src="/images/article/nest-typeorm/d_15.png" />
<br />

<p>그리고 데이터도 2개 심어주었는데, 워크벤치 껐다가 다시 켜니 이전에 심어둔 데이터를 어디서 확인하는지 도통 모르겠다 ㅡㅡ 내 데이터 내놔라 👊</p>
<p>그래서 이건 그냥 shell에서 확인했다.</p>
<img src="/images/article/nest-typeorm/d_16.png" />
<br />

<p><code>desc</code>는 한글로 썼다고 저렇게 표시해주냐 ㅡㅡ 성공한 사람이 되어서 한글을 전세계 제1언어가 되게 하리라. 물론 거짓말이다. 그냥 아무도 모르게 조용히 살고 싶다.</p>
<p>그럼 이제 TypeORM으로 가보자고</p>
<hr>
<h2 id="TypeORM"><a href="#TypeORM" class="headerlink" title="TypeORM"></a>TypeORM</h2><p><strong>ORM</strong>이란 <strong>‘Object Relational Mapping’</strong>의 약자로, 객체-관계 매핑을 의미한다. 풀어서 설명하면, 객체와 관계형 데이터베이스의 데이터를 자동으로 매핑(연결)해주는 것을 말한다.</p>
<p>객체 지향 프로그래밍은 클래스를 사용하고, 관계형 데이터베이스는 테이블을 사용하기 때문에 객체 모델과 관계형 모델 간에 불일치가 존재한다. ORM을 사용하면 객체 간의 관계를 바탕으로 SQL을 자동으로 생성하여 불일치를 해결할 수 있다. </p>
<p>이런 멋드러지는 소리들은 이제 그만하고, NestJS에 TypeORM을 연결해보자.</p>
<p>우선 <code>ormconfig.json</code> 파일을 만든다. (딴소리지만, ORM 대문자로 썼을 때는 꽤나 있어보이는데 orm 소문자로 쓰니까 정말 없어보인다.) 이 config 파일의 옵션들을 앱과 연결시키기 위해 <code>app.module.ts</code> 파일에서 아래와 같이 갖은 방법을 사용했는데,</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TypeOrmModule.forRootAsync(&#123;</span><br><span class="line">  useFactory: <span class="keyword">async</span> () =&gt;</span><br><span class="line">    <span class="built_in">Object</span>.assign(<span class="keyword">await</span> getConnectionOptions(), &#123;</span><br><span class="line">      autoLoadEntities: <span class="literal">true</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>뭘 해도 deprecated된 메서드(<code>getConnectionOptions()</code> 등) 라고 하며 줄이 좍좍 그어졌다 ㅡㅡ</p>
<p>알고 보니 루트 디렉토리에 <code>ormconfig.json</code> 파일이 있다면 <code>TypeOrmModule.forRoot()</code>에 옵션 객체를 전달하지 않아도 된다고 한다. 그니까 그냥 아래처럼 쓰면 된다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Module(&#123;</span><br><span class="line">  imports: [TypeOrmModule.forRoot(), TechStackModule],</span><br><span class="line">  controllers: [...],</span><br><span class="line">  providers: [...]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>fancy하다고 칭찬했던 Nest는 어서 공식문서를 개편하지 않는다면 죽음을 면치 못하리라. 😡</p>
<p>엔티티를 작성해준다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// techstack.entity.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Column, Entity, PrimaryGeneratedColumn, Unique &#125; <span class="keyword">from</span> <span class="string">&#x27;typeorm&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Entity(&#123; <span class="attr">name</span>: <span class="string">&#x27;techstack&#x27;</span> &#125;)</span><br><span class="line">@Unique([<span class="string">&#x27;id&#x27;</span>])</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TechStackEntity</span> </span>&#123;</span><br><span class="line">  @PrimaryGeneratedColumn()</span><br><span class="line">  id: number;</span><br><span class="line"></span><br><span class="line">  @Column(&#123; <span class="attr">type</span>: <span class="string">&#x27;varchar&#x27;</span>, <span class="attr">length</span>: <span class="number">45</span> &#125;)</span><br><span class="line">  name: string;</span><br><span class="line"></span><br><span class="line">  @Column(&#123; <span class="attr">type</span>: <span class="string">&#x27;varchar&#x27;</span>, <span class="attr">length</span>: <span class="number">45</span> &#125;)</span><br><span class="line">  desc: string;</span><br><span class="line"></span><br><span class="line">  @Column(&#123; <span class="attr">type</span>: <span class="string">&#x27;varchar&#x27;</span>, <span class="attr">length</span>: <span class="number">90</span>, <span class="attr">nullable</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  image: string;</span><br><span class="line"></span><br><span class="line">  @Column(&#123; <span class="attr">type</span>: <span class="string">&#x27;varchar&#x27;</span>, <span class="attr">length</span>: <span class="number">45</span>, <span class="attr">nullable</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  url: string;</span><br><span class="line"></span><br><span class="line">  @Column(&#123; <span class="attr">type</span>: <span class="string">&#x27;varchar&#x27;</span>, <span class="attr">length</span>: <span class="number">45</span>, <span class="attr">nullable</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  type: string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>완전 성의없이 MySQL 테이블 형태 그대로 갖다 적었다. <code>PrimaryGeneratedColumn()</code> 데코레이터는, 이름에서도 알 수 있듯이 새로운 데이터가 추가될 때 해당 필드의 값을 자동으로 1씩 증가시켜 할당해준다. 정말 사랑스러운 녀석… </p>
<p>dto가 대체 뭔진 모르겠지만 (물론 Data Transfer Object의 약자라고 한다.) 그냥 인터페이스처럼 만들면 되나보다. 다른 소스들에서 그렇게 하라길래 대충 <code>CreateTechStackDto</code>라고 이름 지어놓고 <code>Create</code>가 아닌 곳에서도 여기저기 갖다 쓰고 있다. </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// techstack.dto.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateTechStackDto</span> </span>&#123;</span><br><span class="line">  name: string;</span><br><span class="line">  desc: string;</span><br><span class="line">  image?: string;</span><br><span class="line">  url?: string;</span><br><span class="line">  type?: string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>id</code>는 위에서 <code>PrimaryGeneratedColumn()</code> 데코레이터가 알아서 지어준다길래 여기서는 뺐다. ㅎㅎ </p>
<p>이제 지쳤으므로 급전개가 이루어질 것이다.</p>
<p>Nest의 프로바이더 역할을 했던 <code>service</code> 파일에, 위에서 생성한 <code>TechStackEntity</code> 를 집어넣는다. 이때 <code>InjectRepository</code> 데코레이터를 사용한다. repository가 바로 db 역할을 하는 것이다! </p>
<p>그리고 메서드들도 수정해준다. 코드는 아래와 같다. </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tech-stacks.service.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; InjectRepository &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/typeorm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStackEntity &#125; <span class="keyword">from</span> <span class="string">&#x27;src/tech-stacks/entity/techstack.entity&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Repository &#125; <span class="keyword">from</span> <span class="string">&#x27;typeorm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CreateTechStackDto &#125; <span class="keyword">from</span> <span class="string">&#x27;./dto/techstack.dto&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Injectable()</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TechStacksService</span> </span>&#123;</span><br><span class="line">  <span class="title">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    @InjectRepository(TechStackEntity)</span></span><br><span class="line"><span class="params">    private techstacksRepository: Repository&lt;TechStackEntity&gt;,</span></span><br><span class="line"><span class="params">  </span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  findAll(): <span class="built_in">Promise</span>&lt;CreateTechStackDto[]&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.techstacksRepository.find();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  findOne(id: number): <span class="built_in">Promise</span>&lt;CreateTechStackDto&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.techstacksRepository.findOne(&#123; <span class="attr">where</span>: &#123; id &#125; &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> createTechStack(item: CreateTechStackDto): <span class="built_in">Promise</span>&lt;<span class="keyword">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="built_in">this</span>.saveTechStack(item);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private <span class="keyword">async</span> <span class="function"><span class="title">saveTechStack</span>(<span class="params">item: CreateTechStackDto</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> techStack = <span class="keyword">new</span> TechStackEntity();</span><br><span class="line">    techStack.name = item.name;</span><br><span class="line">    techStack.desc = item.desc;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="built_in">this</span>.techstacksRepository.save(techStack);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Nest가 제공하는 <code>Repository</code> ****하나로 <code>find()</code>, <code>findOne()</code>, <code>save()</code> 등의 연산을 자동으로 할 수 있다니… 정말 경이롭지 않을 수 없다. </p>
<p>controller 파일에 임시로 심어뒀던 메서드들도 다 갖다 치우고, 새로 단장한 service의 코드를 갖다 쓰는 방식으로 바꿔준다. </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tech-stacks.controller.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Body, Controller, Get, Param, Post &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CreateTechStackDto &#125; <span class="keyword">from</span> <span class="string">&#x27;./dto/techstack.dto&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStacksService &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Controller(<span class="string">&#x27;tech-stacks&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TechStacksController</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">private techStackService: TechStacksService</span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  @Get()</span><br><span class="line">  <span class="keyword">async</span> findAll(): <span class="built_in">Promise</span>&lt;CreateTechStackDto[]&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.techStackService.findAll();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Get(<span class="string">&#x27;/:id&#x27;</span>)</span><br><span class="line">  <span class="keyword">async</span> findOne(@Param(<span class="string">&#x27;id&#x27;</span>) techId: number): <span class="built_in">Promise</span>&lt;CreateTechStackDto&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.techStackService.findOne(techId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Post()</span><br><span class="line">  <span class="keyword">async</span> <span class="function"><span class="title">create</span>(<span class="params">@Body() techStack: CreateTechStackDto</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.techStackService.createTechStack(techStack);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>사실 꼭 <code>Promise</code> 함수로 써야 하는지는 모르겠다. <code>Repository</code>의 내장 메서드들이 <code>Promise</code>를 쓰게 되어있나? 🤔 아아 … 궁금해하지만 말고 찾아보면 될 일. <code>Repository.d.ts</code>에 기재된 타입 시그니처는 대략 다음과 같다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Finds entities that match given find options.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">find(options?: FindManyOptions&lt;Entity&gt;): <span class="built_in">Promise</span>&lt;Entity[]&gt;;</span><br></pre></td></tr></table></figure>

<p>그래, <code>Promise</code>로 쓰란다.</p>
<p>여담이지만, 소스코드를 공개하며 해당 파일명을 알려줄 때는 디렉토리 위치까지 알려줬음 좋겠다. 그게 모두 정답은 아니겠지만… 나도 내 멋대로 했기 때문에 파일명만 공개하기로 😇</p>
<p>이제 마지막으로, 위대한 Nest가 제공한다는 기본 모듈 분리의 원칙에 따라 <code>tech-stacks.module.ts</code> 파일을 생성하고, 코드를 작성해준다. </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Module &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TypeOrmModule &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/typeorm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStackEntity &#125; <span class="keyword">from</span> <span class="string">&#x27;./entity/techstack.entity&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStacksController &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks.controller&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStacksService &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Module(&#123;</span><br><span class="line">  imports: [TypeOrmModule.forFeature([TechStackEntity])],</span><br><span class="line">  providers: [TechStacksService],</span><br><span class="line">  controllers: [TechStacksController],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">TechStackModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>TypeOrmModule.forFeature()</code>는 누가 봐도, <code>TypeOrmModule.forRoot()</code>의 하위 모듈들을 만들기 위한 코드같으므로 설명은 생략한다. (<del>피곤해서 그런 건 아니다</del>) </p>
<p>자 이제 <code>yarn start</code> 로 서버를 실행시켜주면…! 두둥탁 🥁</p>
<img src="/images/article/nest-typeorm/d_17.png" />
<br />
인생은 원래 뜻대로 되는 일이 별로 없다.

<p>게다가 저 마지막 줄에 <code>TechStacksController (?)</code> 물음표는 정말 사람 킹받게 한다.</p>
<img src="/images/article/nest-typeorm/d_18.png" />
<br />

<p>여기저기 수소문한 끝에, 앱의 root가 되는 <code>app.module.ts</code>에서 중복으로 TechStack의 물건들을 갖다 써서 그런다고 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Module &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TypeOrmModule &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/typeorm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStacksController &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks/tech-stacks.controller&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; TechStackModule &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks/tech-stacks.module&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TechStacksService &#125; <span class="keyword">from</span> <span class="string">&#x27;./tech-stacks/tech-stacks.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@Module(&#123;</span><br><span class="line">  imports: [TypeOrmModule.forRoot(), TechStackModule], <span class="comment">// ➕ TechStackModule 추가</span></span><br><span class="line">  controllers: [], <span class="comment">// ➖ TechStacksService 제거</span></span><br><span class="line">  providers: [], <span class="comment">// ➖ TechStacksController 제거</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/article/nest-typeorm/d_19.png" />
<br />

<p>성공 🤩 </p>
<p>마음의 평화가 찾아왔다. </p>
<p>이제 브라우저에서 localhost:3000으로 접속하면 아까 mysql로 봤던 데이터를 확인할 수 있다.</p>
<img src="/images/article/nest-typeorm/d_20.png" />
<br />

<p>포스트맨에서도 물론 잘 나온다규</p>
<img src="/images/article/nest-typeorm/d_21.png" />
<br />

<p>아까 만든 <code>Repository.create()</code> 메서드로 데이터 추가도 할 수 있다. 후후…<br><img src="/images/article/nest-typeorm/d_22.gif" /><br><br /></p>
<p>이제 끝!</p>
<p>이 아니고 프론트 만들러 가자 </p>
<hr>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ul>
<li><a target="_blank" rel="noopener" href="https://wikidocs.net/book/7059">https://wikidocs.net/book/7059</a></li>
<li><a target="_blank" rel="noopener" href="https://gmlwjd9405.github.io/2019/02/01/orm.html">https://gmlwjd9405.github.io/2019/02/01/orm.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Ps8HDIAyPD0&list=PLuHgQVnccGMDeMJsGq2O-55Ymtx0IdKWf">https://www.youtube.com/watch?v=Ps8HDIAyPD0&amp;list=PLuHgQVnccGMDeMJsGq2O-55Ymtx0IdKWf</a></li>
<li><a target="_blank" rel="noopener" href="https://zinirun.github.io/2020/08/15/how-to-use-docker/">https://zinirun.github.io/2020/08/15/how-to-use-docker/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.lainyzine.com/ko/article/docker-exec-executing-command-to-running-container/">https://www.lainyzine.com/ko/article/docker-exec-executing-command-to-running-container/</a></li>
<li><a target="_blank" rel="noopener" href="https://subicura.com/2017/01/19/docker-guide-for-beginners-2.html">https://subicura.com/2017/01/19/docker-guide-for-beginners-2.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hanumoka.net/2018/04/29/docker-20180429-docker-install-mysql/">https://www.hanumoka.net/2018/04/29/docker-20180429-docker-install-mysql/</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>Docker로 MySQL 띄워 NestJS + TypeORM과 연결하기</p><p><a href="https://zigsong.github.io/2022/05/12/nest-typeorm/">https://zigsong.github.io/2022/05/12/nest-typeorm/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>jieun song</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-05-12</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-05-14</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/05/14/refactoring-11-1/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">리팩터링 11장 - 1</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/05/07/2022-5-week-1/"><span class="level-item">5월 1주차 기록</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/profile_hexo.jpeg" alt="zig song"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">zig song</p><p class="is-size-6 is-block">FE Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Seoul</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">158</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">14</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-info is-outlined is-rounded" href="/" target="_self" rel="noopener">Home</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/zigsong"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:wldms5764@gmail.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><ul class="menu-list"><li><a class="level is-mobile" href="#투머치-제목"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">투머치 제목</span></span></a></li></ul><li><a class="level is-mobile" href="#NestJS"><span class="level-left"><span class="level-item">2</span><span class="level-item">NestJS</span></span></a></li><li><a class="level is-mobile" href="#Docker"><span class="level-left"><span class="level-item">3</span><span class="level-item">Docker</span></span></a></li><li><a class="level is-mobile" href="#MySQL"><span class="level-left"><span class="level-item">4</span><span class="level-item">MySQL</span></span></a></li><li><a class="level is-mobile" href="#TypeORM"><span class="level-left"><span class="level-item">5</span><span class="level-item">TypeORM</span></span></a></li><li><a class="level is-mobile" href="#Ref"><span class="level-left"><span class="level-item">6</span><span class="level-item">Ref</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/frontend/"><span class="level-start"><span class="level-item">frontend</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile" href="/categories/git-github/"><span class="level-start"><span class="level-item">git &amp; github</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/javascript/"><span class="level-start"><span class="level-item">javascript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/nestjs/"><span class="level-start"><span class="level-item">nestjs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/oop-true-and-false/"><span class="level-start"><span class="level-item">oop-true-and-false</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/refactoring/"><span class="level-start"><span class="level-item">refactoring</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/retrospective/"><span class="level-start"><span class="level-item">retrospective</span></span><span class="level-end"><span class="level-item tag">32</span></span></a></li><li><a class="level is-mobile" href="/categories/troubleshooting/"><span class="level-start"><span class="level-item">troubleshooting</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/typescript/"><span class="level-start"><span class="level-item">typescript</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/woowacourse/"><span class="level-start"><span class="level-item">woowacourse</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile" href="/categories/wtc-havruta-fe/"><span class="level-start"><span class="level-item">wtc-havruta-fe</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/wtc-pr-log/"><span class="level-start"><span class="level-item">wtc-pr-log</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/wtc-study-log/"><span class="level-start"><span class="level-item">wtc-study-log</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/%EA%B8%80%EB%98%90/"><span class="level-start"><span class="level-item">글또</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/2022/07/16/2022-7-week-3/"><img src="/images/retrospective-thumbnail.jpeg" alt="7월 3주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-15T23:40:20.000Z">2022-07-16</time></p><p class="title"><a href="/2022/07/16/2022-7-week-3/">7월 3주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/07/10/npm-troubleshooting/"><img src="/images/troubleshooting-thumbnail.jpeg" alt="legacy-peer-deps 너 뭐 돼?"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-10T13:51:13.000Z">2022-07-10</time></p><p class="title"><a href="/2022/07/10/npm-troubleshooting/">legacy-peer-deps 너 뭐 돼?</a></p><p class="categories"><a href="/categories/troubleshooting/">troubleshooting</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/07/09/2022-7-week-2/"><img src="/images/retrospective-thumbnail.jpeg" alt="7월 2주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-08T23:39:54.000Z">2022-07-09</time></p><p class="title"><a href="/2022/07/09/2022-7-week-2/">7월 2주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/07/02/2022-7-week-1/"><img src="/images/retrospective-thumbnail.jpeg" alt="7월 1주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-02T05:50:48.000Z">2022-07-02</time></p><p class="title"><a href="/2022/07/02/2022-7-week-1/">7월 1주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/06/25/2022-6-week-4/"><img src="/images/retrospective-thumbnail.jpeg" alt="6월 4주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-06-25T04:59:05.000Z">2022-06-25</time></p><p class="title"><a href="/2022/06/25/2022-6-week-4/">6월 4주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">ZIG-LOG</a><p class="is-size-7"><span>&copy; 2022 jieun song</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>