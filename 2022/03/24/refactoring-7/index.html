<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>리팩터링 7장 - zig-log</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="zig-log"><meta name="msapplication-TileImage" content="/images/balloon-favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="zig-log"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="캡슐화"><meta property="og:type" content="blog"><meta property="og:title" content="리팩터링 7장"><meta property="og:url" content="https://zigsong.github.io/2022/03/24/refactoring-7/"><meta property="og:site_name" content="zig-log"><meta property="og:description" content="캡슐화"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://zigsong.github.io/images/refactoring.jpeg"><meta property="article:published_time" content="2022-03-24T13:50:36.000Z"><meta property="article:modified_time" content="2022-03-24T14:00:51.507Z"><meta property="article:author" content="jieun song"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/refactoring.jpeg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://zigsong.github.io/2022/03/24/refactoring-7/"},"headline":"리팩터링 7장","image":[],"datePublished":"2022-03-24T13:50:36.000Z","dateModified":"2022-03-24T14:00:51.507Z","author":{"@type":"Person","name":"jieun song"},"description":"캡슐화"}</script><link rel="canonical" href="https://zigsong.github.io/2022/03/24/refactoring-7/"><link rel="icon" href="/images/balloon-favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">ZIG-LOG</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/zigsong"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-24T13:50:36.000Z" title="2022. 3. 24. 오후 10:50:36">2022-03-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-24T14:00:51.507Z" title="2022. 3. 24. 오후 11:00:51">2022-03-24</time></span><span class="level-item"><a class="link-muted" href="/categories/refactoring/">refactoring</a></span><span class="level-item">23 minutes read (About 3418 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">리팩터링 7장</h1><div class="content"><h3 id="캡슐화"><a href="#캡슐화" class="headerlink" title="캡슐화"></a>캡슐화</h3><img class="preview" src="/images/refactoring.jpeg">

<span id="more"></span>

<br />

<hr>
<p>모듈을 분리할 때는 각 모듈이 자신을 제외한 다른 부분에 드러내지 않아야 할 비밀을 잘 숨겨야 한다. 이때 레코드 캡슐화, 컬렉션 캡슐화, 기본형을 객체로 바꿔 캡슐화하는 방법 등이 많이 쓰인다. </p>
<p>클래스를 이용하면 내부 정보를 숨길 수 있을 뿐 아니라 위임 숨기기를 통해 클래스 사이의 연결 관계를 숨길 수도 있다. 알고리즘을 함수로 추출하여 구현을 캡슐화하는 방법도 있다.</p>
<hr>
<h2 id="7-1-레코드-캡슐화하기"><a href="#7-1-레코드-캡슐화하기" class="headerlink" title="7.1 레코드 캡슐화하기"></a>7.1 레코드 캡슐화하기</h2><p>가변 데이터를 저장할 때는 레코드보다 객체를 선호한다. 객체를 사용하면 어떻게 저장했는지를 숨긴 채 각각의 값을 서로 다른 메서드로 제공할 수 있다. </p>
<p>레코드 구조는 필드 이름을 노출하는 형태와 필드를 외부로부터 숨겨서 원하는 이름을 쓸 수 있는 형태 두 가지로 구분할 수 있다. 후자는 주로 라이브러리에서 해시(hash), 맵(map), 해시맵(hashmap), 딕셔너리(dictionary), 연관 배열(associative array) 등의 이름으로 제공한다.</p>
<h3 id="절차"><a href="#절차" class="headerlink" title="절차"></a>절차</h3><ol>
<li>레코드를 담은 변수를 캡슐화한다.</li>
<li>레코드를 감싼 단순한 클래스로 해당 변수의 내용을 교체한다. 이 클래스에 원본 레코드를 반환하는 접근자도 정의하고, 변수를 캡슐화하는 함수들이 이 접근자를 사용하도록 수정한다.</li>
<li>테스트한다.</li>
<li>원본 레코드 대신 새로 정의한 클래스 타입의 객체를 반환하는 함수들을 새로 만든다.</li>
<li>레코드를 반환하는 예전 함수를 사용하는 코드를 4에서 만든 새 함수를 사용하도록 바꾼다. 필드에 접근할 때는 객체의 접근자를 사용한다.</li>
<li>클래스에서 원본 데이터를 반환하는 접근자와 원본 레코드를 반환하는 함수들을 제거한다.</li>
<li>테스트한다.</li>
<li>레코드의 필드도 데이터 구조인 중첩 구조라면 레코드 캡슐화하기와 컬렉션 캡슐화하기를 재귀적으로 적용한다.</li>
</ol>
<h3 id="예시-간단한-레코드-캡슐화하기"><a href="#예시-간단한-레코드-캡슐화하기" class="headerlink" title="예시: 간단한 레코드 캡슐화하기"></a>예시: 간단한 레코드 캡슐화하기</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="keyword">const</span> organization = &#123; <span class="attr">name</span>: <span class="string">&quot;에크미 구스베리&quot;</span>, <span class="attr">country</span>: <span class="string">&quot;GB&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">result += <span class="string">`&lt;h1&gt;<span class="subst">$&#123;organization.name&#125;</span>&lt;/h1&gt;`</span> <span class="comment">// 읽기 예</span></span><br><span class="line">organization.name = newName; <span class="comment">// 쓰기 예 </span></span><br></pre></td></tr></table></figure>

<p>레코드를 캡슐화하는 목적은 변수 자체는 물론 그 내용을 조작하는 방식도 통제하기 위함이므로, 레코드를 클래스로 바꾼다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Organization</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">data</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._name = data.name;</span><br><span class="line">    <span class="built_in">this</span>._country = data.country;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span> <span class="title">name</span>(<span class="params">aString</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>._data.name = aString; </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">name</span>() &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._data.name; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> organization = <span class="keyword">new</span> Organization(&#123; <span class="attr">name</span>: <span class="string">&quot;에크미 구스베리&quot;</span>, <span class="attr">country</span>: <span class="string">&quot;GB&quot;</span> &#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getOrganization</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="keyword">return</span> organization; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getOrganization().name = newName;</span><br><span class="line">result += <span class="string">`&lt;h1&gt;<span class="subst">$&#123;getOrganization().name&#125;</span>&lt;/h1&gt;`</span>;</span><br></pre></td></tr></table></figure>

<h3 id="예시-중첩된-레코드-캡슐화하기"><a href="#예시-중첩된-레코드-캡슐화하기" class="headerlink" title="예시: 중첩된 레코드 캡슐화하기"></a>예시: 중첩된 레코드 캡슐화하기</h3><hr>
<h2 id="7-2-컬렉션-캡슐화하기"><a href="#7-2-컬렉션-캡슐화하기" class="headerlink" title="7.2 컬렉션 캡슐화하기"></a>7.2 컬렉션 캡슐화하기</h2><p>컬렉션 변수로의 접근을 캡슐화하면서 게터가 컬렉션 자체를 반환하도록 한다면, 그 컬렉션을 감싼 클래스가 눈치채지 못하는 상태에서 컬렉션의 원소들이 바뀌어버릴 수 있다. 컬렉션 게터가 원본 컬렉션을 반환하지 않게 만들어서 클라이언트가 실수로 컬렉션을 바꿀 가능성을 차단하는 것이 좋다.</p>
<p>내부 컬렉션을 직접 수정하지 못하게 막는 방법 중 하나로, 절대로 컬렉션 값을 반환하지 않게 할 수 있다. 컬렉션에 접근하려면 컬렉션이 소속된 클래스의 적절한 메서드를 반드시 거치게 하는 것이다.</p>
<p>또 다른 방법은 컬렉션을 읽기전용으로 제공할 수 있다. 프락시가 내부 컬렉션을 읽는 연산은 그대로 전달하고, 쓰기는 모두 막는 것이다.</p>
<p>가장 흔히 사용하는 방식은 아마도 컬렉션 게터를 제공하되 내부 컬렉션의 복제본을 반환하는 것이다. 복제본을 수정해도 캡슐화된 원본 컬렉션에는 아무런 영향을 주지 않는다.</p>
<p>여기서 중요한 점은 코드베이스에 일관성을 주는 것이다. 컬렉션 접근 함수의 동작 방식을 통일해야 한다.</p>
<h3 id="절차-1"><a href="#절차-1" class="headerlink" title="절차"></a>절차</h3><ol>
<li>아직 컬렉션을 캡슐화하지 않았다면 변수 캡슐화하기부터 한다.</li>
<li>컬렉션에 원소를 추가/제거하는 함수를 추가한다.</li>
<li>정적 검사를 수행한다.</li>
<li>컬렉션을 참조하는 부분을 모두 찾는다. 컬렉션의 변경자를 호출하는 코드가 모두 앞에서 추가한 추가/제거 함수를 호출하도록 수정한다.</li>
<li>컬렉션 게터를 수정해서 원본 내용을 수정할 수 없는 읽기전용 프락시나 복제본을 반환하게 한다.</li>
<li>테스트한다.</li>
</ol>
<h3 id="예시"><a href="#예시" class="headerlink" title="예시"></a>예시</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._name = name;</span><br><span class="line">    <span class="built_in">this</span>._courses = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">get</span> <span class="title">name</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._name; &#125;</span><br><span class="line">	<span class="keyword">get</span> <span class="title">courses</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._courses; &#125;</span><br><span class="line">	<span class="keyword">set</span> <span class="title">courses</span>(<span class="params">aList</span>) &#123; <span class="built_in">this</span>._courses = aList; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name, isAdvanced</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._name = name;</span><br><span class="line">    <span class="built_in">this</span>._isAdvanced = isAdvanced;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">name</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._name; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">isAdvanced</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._isAdvanced; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>모든 필드가 접근자 메서드로 보호받고 있으나, 세터를 이용해 수업 컬렉션을 통째로 설정한 클라이언트는 누구든 이 컬렉션을 마음대로 수정할 수 있다. 캡슐화가 깨지는 것이다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// after</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="comment">// setter 제거</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">courses</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._courses.slice(); &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">addCourse</span>(<span class="params">aCourse</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._courses.push(aCourse);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">removeCourse</span>(<span class="params">aCourse, fnIfAbsent = () =&gt; &#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>(); &#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> index = <span class="built_in">this</span>._courses.indexOf(aCourse);</span><br><span class="line">    <span class="keyword">if</span> (index === -<span class="number">1</span>) fnIfAbsent();</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">this</span>._courses.splice(index, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-3-기본형을-객체로-바꾸기"><a href="#7-3-기본형을-객체로-바꾸기" class="headerlink" title="7.3 기본형을 객체로 바꾸기"></a>7.3 기본형을 객체로 바꾸기</h2><p>단순한 출력 이상의 기능이 필요해지는 순간 그 데이터를 표현하는 전용 클래스를 정의한다. </p>
<h3 id="절차-2"><a href="#절차-2" class="headerlink" title="절차"></a>절차</h3><ol>
<li>아직 변수를 캡슐화하지 않았다면 캡슐화한다.</li>
<li>단순한 값 클래스를 만든다. 생성자는 기존 값을 인수로 받아서 저장하고, 이 값을 반환하는 게터를 추가한다.</li>
<li>정적 검사를 수행한다.</li>
<li>값 클래스의 인스턴스를 새로 만들어서 필드에 저장하도록 세터를 수정한다. 이미 있다면 필드의 타입을 적절히 변경한다.</li>
<li>새로 만든 클래스의 게터를 호출한 결과를 반환하도록 게터를 수정한다.</li>
<li>테스트한다.</li>
<li>함수 이름을 바꾸면 원본 접근자의 동작을 더 잘 드러낼 수 있는지 검토한다.</li>
</ol>
<h3 id="예시-1"><a href="#예시-1" class="headerlink" title="예시"></a>예시</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">data</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.priority = data.priority;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 클라이언트</span></span><br><span class="line"><span class="keyword">const</span> highPriorityCount = orders.filter(<span class="function"><span class="params">o</span> =&gt;</span> <span class="string">&quot;high&quot;</span> === o.priority || <span class="string">&quot;rush&quot;</span> === o.priority).length;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// after </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">priority</span>() &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._priority; </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">priority</span>(<span class="params">aString</span>) &#123; </span><br><span class="line">    <span class="built_in">this</span>._priority = <span class="keyword">new</span> Priority(aString); </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Priority</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">value</span>)</span> &#123; </span><br><span class="line">    <span class="built_in">this</span>._value = value; </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span> &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._value; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> highPriorityCount = orders.filter(<span class="function"><span class="params">o</span> =&gt;</span> <span class="string">&quot;high&quot;</span> === o.priority.toString() || <span class="string">&quot;rush&quot;</span> === o.priority.toString()).length;</span><br></pre></td></tr></table></figure>

<p>이렇게 하면 <code>Priority</code> 클래스를 새로운 동작을 담는 장소로 활용할 수 있게 된다</p>
<hr>
<h2 id="7-4-임시-변수를-질의-함수로-바꾸기"><a href="#7-4-임시-변수를-질의-함수로-바꾸기" class="headerlink" title="7.4 임시 변수를 질의 함수로 바꾸기"></a>7.4 임시 변수를 질의 함수로 바꾸기</h2><p>임시 변수를 사용하면 코드의 반복을 줄이고 값의 의미를 설명할 수도 있어 유용하다. 여기서 한 걸음 더 나아가 아예 함수로 만들어 사용하는 편이 나을 때가 많다.</p>
<p>변수 대신 함수로 만들어두면 비슷한 계산을 수행하는 다른 함수에서도 사용할 수 있어 코드 중복이 줄어든다. 특히 추출할 메서드들에 공유 컨텍스트를 제공하는 클래스 안에서 적용할 때 효과가 가장 크다. </p>
<h3 id="절차-3"><a href="#절차-3" class="headerlink" title="절차"></a>절차</h3><ol>
<li>변수가 사용되기 전에 값이 확실히 결정되는지, 변수를 사용할 때마다 계산 로직이 매번 다른 결과를 내지는 않는지 확인한다.</li>
<li>읽기전용으로 만들 수 있는 변수는 읽기전용으로 만든다.</li>
<li>테스트한다.</li>
<li>변수 대입문을 함수로 추출한다.</li>
<li>테스트한다.</li>
<li>변수 인라인하기로 임시 변수를 제거한다.</li>
</ol>
<h3 id="예시-2"><a href="#예시-2" class="headerlink" title="예시"></a>예시</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">quantity, item</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._quantity = quantity;</span><br><span class="line">    <span class="built_in">this</span>._item = item;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">price</span>() &#123;</span><br><span class="line">    <span class="keyword">var</span> basePrice = <span class="built_in">this</span>._quantity * <span class="built_in">this</span>._item.price;</span><br><span class="line">    <span class="keyword">var</span> discountFactor = <span class="number">0.98</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (basePrice &gt; <span class="number">1000</span>) discountFactor -= <span class="number">0.03</span>;</span><br><span class="line">    <span class="keyword">return</span> basePrice * discountFactor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// after </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">quantity, item</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._quantity = quantity;</span><br><span class="line">    <span class="built_in">this</span>._item = item;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">price</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.basePrice * <span class="built_in">this</span>.discountFactor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">basePrice</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._quantity * <span class="built_in">this</span>._item.price;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">discountFactor</span>() &#123;</span><br><span class="line">    <span class="keyword">var</span> discountFactor = <span class="number">0.98</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (basePrice &gt; <span class="number">1000</span>) discountFactor -= <span class="number">0.03</span>;</span><br><span class="line">    <span class="keyword">return</span> discountFactor;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-5-클래스-추출하기"><a href="#7-5-클래스-추출하기" class="headerlink" title="7.5 클래스 추출하기"></a>7.5 클래스 추출하기</h2><p>메서드와 데이터가 너무 많은 클래스는 이해하기가 쉽지 않으니 잘 살펴보고 적절히 분리하는 것이 좋다. 함께 변경되는 일이 많거나 서로 의존하는 테이블들도 분리한다.</p>
<h3 id="절차-4"><a href="#절차-4" class="headerlink" title="절차"></a>절차</h3><ol>
<li>클래스의 역할을 분리할 방법을 정한다.</li>
<li>분리될 역할을 담당할 클래스를 새로 만든다.</li>
<li>원래 클래스의 생성자에서 새로운 클래스의 인스턴스를 생성하여 필드에 저장해둔다.</li>
<li>분리될 역할에 필요한 필드들을 새 클래스로 옮긴다.</li>
<li>메서드들도 새 클래스로 옮긴다. 이때 저수준 메서드, 즉 다른 메서드를 호출하기보다는 호출을 당하는 일이 많은 메서드부터 옮긴다. </li>
<li>양쪽 클래스의 인터페이스를 살펴보면서 불필요한 메서드를 제거하고, 이름도 새로운 환경에 맞게 바꾼다.</li>
<li>새 클래스를 외부로 노출할지 정한다. 노출하려거든 새 클래스에 참조를 값으로 바꾸기를 적용할지 고민해본다.</li>
</ol>
<h3 id="예시-3"><a href="#예시-3" class="headerlink" title="예시"></a>예시</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">name</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._name; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">name</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._name = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">telephoneNumber</span>() &#123; <span class="keyword">return</span> <span class="string">`(<span class="subst">$&#123;<span class="built_in">this</span>.officeAreaCode&#125;</span>) <span class="subst">$&#123;<span class="built_in">this</span>.officeNumber&#125;</span>`</span>; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">officeAreaCode</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._officeAreaCode; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">officeAreaCode</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._officeAreaCode = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">officeNumber</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._officeNumber; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">officeNumber</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._officeNumber = arg; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// after</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._telephoneNumber = <span class="keyword">new</span> TelephoneNumber();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">name</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._name; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">name</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._name = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">telephoneNumber</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._telephoneNumber.toString(); &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">areaCode</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._telephoneNumber.areaCode; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">areaCode</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._telephoneNumber.areaCode = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">officeNumber</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._telephoneNumber.number; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">officeNumber</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._telephoneNumber.number = arg; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TelephoneNumber</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">areaCode</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._areaCode; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">areaCode</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._areaCode = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">number</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._number; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">number</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._number = arg; &#125;</span><br><span class="line">  <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span> &#123; <span class="keyword">return</span> <span class="string">`(<span class="subst">$&#123;<span class="built_in">this</span>.areaCode&#125;</span>) <span class="subst">$&#123;<span class="built_in">this</span>.number&#125;</span>`</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-6-클래스-인라인하기"><a href="#7-6-클래스-인라인하기" class="headerlink" title="7.6 클래스 인라인하기"></a>7.6 클래스 인라인하기</h2><p>클래스 인라인하기는 클래스 추출하기를 거꾸로 돌리는 리팩터링이다.</p>
<p>더 이상 제 역할을 못 해서 그대로 두면 안 되는 클래스는 인라인한다. 두 클래스의 기능을 지금과 다르게 배분하고 싶을 때도 클래스를 인라인한다.</p>
<h3 id="절차-5"><a href="#절차-5" class="headerlink" title="절차"></a>절차</h3><ol>
<li>소스 클래스의 각 public 메서드에 대응하는 메서드들을 타깃 클래스에 생성한다. </li>
<li>소스 클래스의 메서드를 사용하는 코드를 모두 타깃 클래스의 위임 메서드를 사용하도록 바꾼다.</li>
<li>소스 클래스의 메서드와 필드를 모두 타깃 클래스로 옮긴다.</li>
<li>소스 클래스를 삭제하고 조의를 표한다.</li>
</ol>
<h3 id="예시-4"><a href="#예시-4" class="headerlink" title="예시"></a>예시</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrackingInformation</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">shippingCompany</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._shippingCompany; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">shippingCompany</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._shippingCompany = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">trackingNumber</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._trackingNumber; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">trackingNumber</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._trackingNumber = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">display</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.shippingCompany&#125;</span>: <span class="subst">$&#123;<span class="built_in">this</span>.trackingNumber&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shipment</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">trackingInfo</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>._trackingInformation.display;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">trackingInformation</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._trackingInformation; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">trackingInformation</span>(<span class="params">aTrackingInformation</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>._trackingInformation = aTrackingInformation;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>TrackingInformation</code>이 현재는 제 역할을 못 하고 있으니 <code>Shipment</code> 클래스로 인라인한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shipment</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">trackingInfo</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.shippingCompany&#125;</span>: <span class="subst">$&#123;<span class="built_in">this</span>.trackingNumber&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">shippingCompany</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._shippingCompany; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">shippingCompany</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._shippingCompany = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">trackingNumber</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._trackingNumber; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">trackingNumber</span>(<span class="params">arg</span>) &#123; <span class="built_in">this</span>._trackingNumber = arg; &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><code>TrackingInformation</code> 클래스는 삭제한다.</p>
<hr>
<h2 id="7-7-위임-숨기기"><a href="#7-7-위임-숨기기" class="headerlink" title="7.7 위임 숨기기"></a>7.7 위임 숨기기</h2><p>모듈화 설계를 제대로 하는 핵심은 캡슐화다. 캡슐화는 모듈들이 시스템의 다른 부분에 대해 알아야 할 내용을 줄여준다.</p>
<h3 id="절차-6"><a href="#절차-6" class="headerlink" title="절차"></a>절차</h3><ol>
<li>위임 객체의 각 메서드에 해당하는 위임 메서드를 서버에 생성한다.</li>
<li>클라이언트가 위임 객체 대신 서버를 호출하도록 수정한다.</li>
<li>모두 수정했다면, 서버로부터 위임 객체를 얻는 접근자를 제거한다.</li>
<li>테스트한다.</li>
</ol>
<h3 id="예시-5"><a href="#예시-5" class="headerlink" title="예시"></a>예시</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">name</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._name; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">department</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._department; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">department</span>() &#123; <span class="built_in">this</span>._department = arg; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Department</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">chargeCode</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._chargeCode; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">chargeCode</span>() &#123; <span class="built_in">this</span>._chargeCode = arg; &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">manager</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._manager; &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title">manager</span>() &#123; <span class="built_in">this</span>._manager = arg; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 클라이언트</span></span><br><span class="line"><span class="keyword">const</span> manager = aPerson.department.manager;</span><br></pre></td></tr></table></figure>

<p>클라이언트가 <code>Department</code> 클래스를 몰라도 되도록, <code>Person</code> 클래스에 간단한 위임 메서드를 만들어 의존성을 줄일 수 있다. </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// after</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...  </span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">manager</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._department.manager; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 클라이언트</span></span><br><span class="line"><span class="keyword">const</span> manager = aPerson.manager;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-8-중개자-제거하기"><a href="#7-8-중개자-제거하기" class="headerlink" title="7.8 중개자 제거하기"></a>7.8 중개자 제거하기</h2><p>위임 메서드를 매번 추가하다 보면 서버 클래스는 그저 중개자 역할로 전락하여, 차라리 클라이언트가 위임 객체를 직접 호출하는 게 나을 수 있다. </p>
<h3 id="절차-7"><a href="#절차-7" class="headerlink" title="절차"></a>절차</h3><ol>
<li>위임 객체를 얻는 게터를 만든다.</li>
<li>위임 메서드를 호출하는 클라이언트가 모두 이 게터를 거치도록 수정한다.</li>
<li>모두 수정했다면 위임 메서드를 삭제한다.</li>
</ol>
<h3 id="예시-6"><a href="#예시-6" class="headerlink" title="예시"></a>예시</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="keyword">const</span> manager = aPerson.manager;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">manager</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._department.manager; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Department</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">manager</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._manager; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// after</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title">department</span>() &#123; <span class="keyword">return</span> <span class="built_in">this</span>._department; &#125;</span><br><span class="line">  <span class="comment">// 삭제</span></span><br><span class="line">  <span class="comment">// get manager() &#123; return this._department.manager; &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 클라이언트</span></span><br><span class="line"><span class="keyword">const</span> manager = aPerson.department.manager;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-9-알고리즘-교체하기"><a href="#7-9-알고리즘-교체하기" class="headerlink" title="7.9 알고리즘 교체하기"></a>7.9 알고리즘 교체하기</h2><p>메서드를 잘게 나누어 알고리즘을 간소화하자.</p>
<h3 id="절차-8"><a href="#절차-8" class="headerlink" title="절차"></a>절차</h3><ol>
<li>교체할 코드를 함수 하나에 모은다.</li>
<li>이 함수만을 이용해 동작을 검증하는 테스트를 마련한다.</li>
<li>대체할 알고리즘을 준비한다.</li>
<li>정적 검사를 수행한다.</li>
<li>기존 알고리즘과 새 알고리즘의 결과를 비교하는 테스트를 수행한다.</li>
</ol>
</div><div class="article-licensing box"><div class="licensing-title"><p>리팩터링 7장</p><p><a href="https://zigsong.github.io/2022/03/24/refactoring-7/">https://zigsong.github.io/2022/03/24/refactoring-7/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>jieun song</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-03-24</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-03-24</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/03/25/2022-3-week-4/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">3월 4주차 기록</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/03/20/oop-true-and-false-7/"><span class="level-item">객체지향의 사실과 오해 - 7장</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/profile_hexo.jpeg" alt="zig song"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">zig song</p><p class="is-size-6 is-block">FE Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Seoul</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">158</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">14</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-info is-outlined is-rounded" href="/" target="_self" rel="noopener">Home</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/zigsong"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:wldms5764@gmail.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><ul class="menu-list"><li><a class="level is-mobile" href="#캡슐화"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">캡슐화</span></span></a></li></ul><li><a class="level is-mobile" href="#7-1-레코드-캡슐화하기"><span class="level-left"><span class="level-item">2</span><span class="level-item">7.1 레코드 캡슐화하기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시-간단한-레코드-캡슐화하기"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">예시: 간단한 레코드 캡슐화하기</span></span></a></li><li><a class="level is-mobile" href="#예시-중첩된-레코드-캡슐화하기"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">예시: 중첩된 레코드 캡슐화하기</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-2-컬렉션-캡슐화하기"><span class="level-left"><span class="level-item">3</span><span class="level-item">7.2 컬렉션 캡슐화하기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-1"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">예시</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-3-기본형을-객체로-바꾸기"><span class="level-left"><span class="level-item">4</span><span class="level-item">7.3 기본형을 객체로 바꾸기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-2"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시-1"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">예시</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-4-임시-변수를-질의-함수로-바꾸기"><span class="level-left"><span class="level-item">5</span><span class="level-item">7.4 임시 변수를 질의 함수로 바꾸기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-3"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시-2"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">예시</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-5-클래스-추출하기"><span class="level-left"><span class="level-item">6</span><span class="level-item">7.5 클래스 추출하기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-4"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시-3"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">예시</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-6-클래스-인라인하기"><span class="level-left"><span class="level-item">7</span><span class="level-item">7.6 클래스 인라인하기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-5"><span class="level-left"><span class="level-item">7.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시-4"><span class="level-left"><span class="level-item">7.2</span><span class="level-item">예시</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-7-위임-숨기기"><span class="level-left"><span class="level-item">8</span><span class="level-item">7.7 위임 숨기기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-6"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시-5"><span class="level-left"><span class="level-item">8.2</span><span class="level-item">예시</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-8-중개자-제거하기"><span class="level-left"><span class="level-item">9</span><span class="level-item">7.8 중개자 제거하기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-7"><span class="level-left"><span class="level-item">9.1</span><span class="level-item">절차</span></span></a></li><li><a class="level is-mobile" href="#예시-6"><span class="level-left"><span class="level-item">9.2</span><span class="level-item">예시</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-9-알고리즘-교체하기"><span class="level-left"><span class="level-item">10</span><span class="level-item">7.9 알고리즘 교체하기</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#절차-8"><span class="level-left"><span class="level-item">10.1</span><span class="level-item">절차</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/frontend/"><span class="level-start"><span class="level-item">frontend</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile" href="/categories/git-github/"><span class="level-start"><span class="level-item">git &amp; github</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/javascript/"><span class="level-start"><span class="level-item">javascript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/nestjs/"><span class="level-start"><span class="level-item">nestjs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/oop-true-and-false/"><span class="level-start"><span class="level-item">oop-true-and-false</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/refactoring/"><span class="level-start"><span class="level-item">refactoring</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/retrospective/"><span class="level-start"><span class="level-item">retrospective</span></span><span class="level-end"><span class="level-item tag">32</span></span></a></li><li><a class="level is-mobile" href="/categories/troubleshooting/"><span class="level-start"><span class="level-item">troubleshooting</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/typescript/"><span class="level-start"><span class="level-item">typescript</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/woowacourse/"><span class="level-start"><span class="level-item">woowacourse</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile" href="/categories/wtc-havruta-fe/"><span class="level-start"><span class="level-item">wtc-havruta-fe</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/wtc-pr-log/"><span class="level-start"><span class="level-item">wtc-pr-log</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/wtc-study-log/"><span class="level-start"><span class="level-item">wtc-study-log</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/%EA%B8%80%EB%98%90/"><span class="level-start"><span class="level-item">글또</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/2022/07/16/2022-7-week-3/"><img src="/images/retrospective-thumbnail.jpeg" alt="7월 3주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-15T23:40:20.000Z">2022-07-16</time></p><p class="title"><a href="/2022/07/16/2022-7-week-3/">7월 3주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/07/10/npm-troubleshooting/"><img src="/images/troubleshooting-thumbnail.jpeg" alt="legacy-peer-deps 너 뭐 돼?"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-10T13:51:13.000Z">2022-07-10</time></p><p class="title"><a href="/2022/07/10/npm-troubleshooting/">legacy-peer-deps 너 뭐 돼?</a></p><p class="categories"><a href="/categories/troubleshooting/">troubleshooting</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/07/09/2022-7-week-2/"><img src="/images/retrospective-thumbnail.jpeg" alt="7월 2주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-08T23:39:54.000Z">2022-07-09</time></p><p class="title"><a href="/2022/07/09/2022-7-week-2/">7월 2주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/07/02/2022-7-week-1/"><img src="/images/retrospective-thumbnail.jpeg" alt="7월 1주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-07-02T05:50:48.000Z">2022-07-02</time></p><p class="title"><a href="/2022/07/02/2022-7-week-1/">7월 1주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2022/06/25/2022-6-week-4/"><img src="/images/retrospective-thumbnail.jpeg" alt="6월 4주차 기록"></a></figure><div class="media-content"><p class="date"><time dateTime="2022-06-25T04:59:05.000Z">2022-06-25</time></p><p class="title"><a href="/2022/06/25/2022-6-week-4/">6월 4주차 기록</a></p><p class="categories"><a href="/categories/retrospective/">retrospective</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">ZIG-LOG</a><p class="is-size-7"><span>&copy; 2022 jieun song</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>