{"componentChunkName":"component---src-templates-blog-post-js","path":"/frontend/webpack-config/","result":{"data":{"site":{"siteMetadata":{"title":"ziglog","author":"zigsong","lang":"en"}},"markdownRemark":{"id":"3a6bc5a7-0686-58da-a472-eb423815a213","excerpt":"it’s 재정비 타임~ 놀토 프로젝트에서 사용하는 webpack 설정 재정비 중! ✅ webpack dev prod config 분리 development와 production의 빌드 목표는 서로 다르다. development에서는 강력한 소스 매핑, localhost…","html":"<p>it’s 재정비 타임~</p>\n<!-- more -->\n<p>놀토 프로젝트에서 사용하는 webpack 설정 재정비 중!</p>\n<h3 id=\"-webpack-dev-prod-config-분리\" style=\"position:relative;\"><a href=\"#-webpack-dev-prod-config-%EB%B6%84%EB%A6%AC\" aria-label=\" webpack dev prod config 분리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ webpack dev prod config 분리</h3>\n<p>development와 production의 빌드 목표는 서로 다르다. development에서는 강력한 소스 매핑, localhost 서버에서는 라이브 리로딩이나 HMR(Hot Module Replacement) 기능을 원한다. production의 목표는 로드 시간을 줄이기 위해 번들 최소화, 가벼운 소스맵 및 에셋 최적화에 초점을 맞춰야 한다. 공식 문서에서는 webpack 설정을 분리하여 작성하는 것을 권장하고 있다.</p>\n<p>dev와 prod에서 공통으로 사용하는 설정들은 <strong>webpack.common.js</strong>에 작성하고, <code class=\"language-text\">webpack-merge</code>를 사용하여 common의 설정 내용을 dev와 prod에서 확장하여 사용할 수 있다.</p>\n<h3 id=\"-babelpreset-env의-target-browserslist-설정하기\" style=\"position:relative;\"><a href=\"#-babelpreset-env%EC%9D%98-target-browserslist-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\" babelpreset env의 target browserslist 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ babel/preset-env의 target browserslist 설정하기</h3>\n<p>앱을 만들 때 지원할 브라우저를 명시할 수 있다. ES6와 같은 최신 자바스크립트 문법을 사용할 때 browserslist를 명시해 주면, 트랜스파일러나 모듈 번들러가 현재 타겟으로 하는 브라우저를 알 수 있다. 최신 문법을 지원하지 않는 브라우저(IE 11버전 이하)를 그대로 사용한다면 별도의 polyfill을 설치해줘야 한다.</p>\n<p>현재 프로젝트에서는 크롬 50버전 이상 또는 전체 브라우저의 최신 2개의 버전을 지원하며, IE 11 버전 이하의 브라우저는 지원하지 않기로 했다. 전체 query 목록은 <a href=\"https://github.com/browserslist/browserslist#queries\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기</a>서 확인할 수 있다.</p>\n<p>babel의 <code class=\"language-text\">@babel/preset-env</code> 설정에 browserslist를 명시해주는 방법도 있지만, 현재 패키지에서 확인하는 방법이 좋다고 생각하여 package.json에 작성 후 webpack에서 참조하도록 했다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// package.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token string-property property\">\"browserslist\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"chrome > 50 or last 2 versions and not ie &lt;= 11\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>webpack에는 아래와 같이 적어주었다. browserslist 설정이 있다면 <code class=\"language-text\">target</code> 옵션은 디폴트로 해당 browserslist를 가리키게 된다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// webpack.config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token literal-property property\">target</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browserslist\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>아래 명령어를 통해 현재 앱에서 타겟 환경으로 지정한 브라우저와 그 버전을 명시한 목록을 볼 수 있다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npx browserslist</code></pre></div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/5324c9ad5c1371d5c0091a1f84a4ae4b/cc8d6/01.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.513513513513516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhElEQVQoz63OPQ6CQBgG4XexIbi7LCauCUIFCYbYUHoPAX8S73+L8RJfMe2T0TRNVJcNxQ2XVlQ/UXqh9Eb1itKO0gfX7LjjDz3u6Cu0iupWkZtMe23JOVOWJRqGgXw+IcmmcRzpuo6iONiAfd8TY7Q79N7jnLMD53m2PVyWxR4MIZiBfx+rqr5CSGFAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"01\" title=\"01\" src=\"/static/5324c9ad5c1371d5c0091a1f84a4ae4b/fcda8/01.png\" srcset=\"/static/5324c9ad5c1371d5c0091a1f84a4ae4b/12f09/01.png 148w,\n/static/5324c9ad5c1371d5c0091a1f84a4ae4b/e4a3f/01.png 295w,\n/static/5324c9ad5c1371d5c0091a1f84a4ae4b/fcda8/01.png 590w,\n/static/5324c9ad5c1371d5c0091a1f84a4ae4b/cc8d6/01.png 791w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3 id=\"-file-loader-대신-assetresource\" style=\"position:relative;\"><a href=\"#-file-loader-%EB%8C%80%EC%8B%A0-assetresource\" aria-label=\" file loader 대신 assetresource permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ file-loader 대신 asset/resource</h3>\n<p>file-loader 모듈은 개발 시 <code class=\"language-text\">import</code>/<code class=\"language-text\">require</code> 구문으로 사용되는 에셋 파일들을 번들 결과의 output 폴더에 생성해준다. webpack v5부터 deprecate되었으며, 현재는 asset/resource를 사용한다. <code class=\"language-text\">generator</code> 옵션을 사용하여 번들 이후 생성될 파일의 이름을 설정해줄 수 있다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// webpack.config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token literal-property property\">module</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">rules</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token comment\">// ...</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.(png|jpe?g|gif|webp)$</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">i</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"asset/resource\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">generator</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">filename</span><span class=\"token operator\">:</span> <span class=\"token string\">\"static/[name][ext]\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"-타입-체킹-기능-사용\" style=\"position:relative;\"><a href=\"#-%ED%83%80%EC%9E%85-%EC%B2%B4%ED%82%B9-%EA%B8%B0%EB%8A%A5-%EC%82%AC%EC%9A%A9\" aria-label=\" 타입 체킹 기능 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 타입 체킹 기능 사용</h3>\n<p>babel은 ES6 코드를 ES5 이하의 문법으로 컴파일해주지만, 타입 체크는 해주지 않는다. babel에서 기본으로 제공하는 <code class=\"language-text\">@babel/preset-typescript</code> preset은 타입스크립트 문법을 브라우저가 이해할 수 있게끔 해주는 역할만 수행할 뿐, 타입 체크를 해주지 않는다. 별도의 타입 체크를 위해 tsc와 같은 타입스크립트 컴파일러를 설치하여 타입 체크를 수행할 수 있지만, 그보다 webpack과의 결합도를 위해 <code class=\"language-text\">fork-ts-checker-webpack-plugin</code>을 사용하였다. <code class=\"language-text\">fork-ts-checker-webpack-plugin</code>은 babel 컴파일 과정에서 별도로 동작하여, 타입 체크와 babel 컴파일을 병렬적으로 수행할 수 있다는 장점이 있다.</p>\n<blockquote>\n<p>ts-loader를 사용하여 babel에서 타입 체크를 수행할 수 있지만, 혼자 트랜스파일링과 타입 체크를 모두 다 하게 되기 때문에 느리다는 단점이 있다. 공식 문서에서는 babel-loader의 사용을 권장한다.</p>\n</blockquote>\n<h3 id=\"-defineplugin\" style=\"position:relative;\"><a href=\"#-defineplugin\" aria-label=\" defineplugin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ DefinePlugin</h3>\n<p>컴파일 타임에 사용할 값들을 지정해준다. 구체적으로는 production mode에서 사용할 환경변수들을 가져와 정의해줄 수 있다. Github Actions나 Jenkins 등 CI/CD를 도와주는 툴에 secret variable로 앱에서 사용하는 API key 등의 환경변수를 설정하고, 빌드 시점에 해당 환경에서 필요한 변수를 취득하여 앱에 적용해 준다.</p>\n<p>production mode에서 SENTRY의 DSN을 불러와 사용해주기 위해 작성해주었다. DefinePlugin의 key-value 쌍에서 key값은 항상 아래처럼 문자열로 감싸줘야 하며, value도 <code class=\"language-text\">JSON.stringify</code>로 바꿔줘야 한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// webpack.config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">DefinePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">\"process.env.SENTRY_DSN\"</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">SENTRY_DSN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<blockquote>\n<p><code class=\"language-text\">DefinePlugin</code>과 유사하게 동작하지만, 환경 변수 전용으로 사용되는 <code class=\"language-text\">EnvironmentPlugin</code>이라는 플러그인도 있다.</p>\n</blockquote>\n<h3 id=\"-filename-vs-chunkfilename\" style=\"position:relative;\"><a href=\"#-filename-vs-chunkfilename\" aria-label=\" filename vs chunkfilename permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ filename vs chunkfilename</h3>\n<ul>\n<li><strong>filename</strong> - 각 출력 번들의 이름을 결정하며, 각 번들에 대해 독립적이다. 단일 entry 지점의 경우 정적인 이름으로 설정할 수 있다. (ex. bundle.js)</li>\n<li><strong>chunkFilename</strong> - 초기가 아닌 청크 파일의 이름을 결정하며, 런타임에서 파일 이름을 생성한다. 코드 스플리팅 시 webpack에 의해 자동 생성되는 파일 이름이다. (async chunk의 경우 chunkFilename 채택하는 듯하다. 그런데 아직 잘 안 된다 😵)</li>\n</ul>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// webpack.config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">output</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>\\_\\_dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'./dist'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">filename</span><span class=\"token operator\">:</span> <span class=\"token string\">'[name].[chunkhash].js'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">chunkFilename</span><span class=\"token operator\">:</span> <span class=\"token string\">'[id].js'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">publicPath</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"-tree-shaking을-위한-sideeffects-설정\" style=\"position:relative;\"><a href=\"#-tree-shaking%EC%9D%84-%EC%9C%84%ED%95%9C-sideeffects-%EC%84%A4%EC%A0%95\" aria-label=\" tree shaking을 위한 sideeffects 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ Tree-shaking을 위한 sideEffects 설정</h3>\n<p>tree-shaking은 사용하지 않는 코드를 제거함으로써 용량을 줄이는 방식을 말한다. webpack은 v5부터 <strong>terser</strong> 라이브러리를 통해 기본적인 tree-shaking을 수행하고 있다.</p>\n<p>하지만 ESM의 <code class=\"language-text\">import</code>/<code class=\"language-text\">export</code> 키워드를 사용할 때, <code class=\"language-text\">import</code>한 모듈들을 아무 곳에서도 참조하지 않는 등의 상황이 발생하면 webpack의 tree-shaking 과정에서 문제가 생긴다. 따라서 tree-shaking 시 sideEffects가 발생하지 않을 것이라고 개발자가 webpack을 안심시켜줘야(?) 한다.</p>\n<p>package.json에 <code class=\"language-text\">sideEffects: false</code> 옵션을 명시해준다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// package.json</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token string-property property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"nolto\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.1\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"sideEffects\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">import</code>한 모듈을 사용하지 않는 경우 외에도 tree-shaking이 적용되지 않는 경우들은 아래와 같다.</p>\n<ul>\n<li>전역 함수를 사용하는 경우</li>\n<li>함수 실행 코드에서 멤버변수를 변경하고 반환하는 경우</li>\n<li>static class properties를 사용하는 경우</li>\n<li>class를 사용하는 경우 등</li>\n</ul>\n<blockquote>\n<p>원래는 babel config에 “modules”: false 옵션까지 지정하여, babel이 import 구문까지 commonJS의 require로 바꿔주는 것을 방지했다. (webpack의 tree-shaking은 import문만 이해하기 때문) 하지만 해당 옵션은 default로 false가 적용된다고 한다.</p>\n</blockquote>\n<blockquote>\n<p>CommonJS의 <code class=\"language-text\">require</code>는 동기적으로 이루어진다. (원래 Node.js를 위한 것이며, 브라우저용으로 탄생한 방식이 아니다!) 반면 ESM은 가져온 스크립트를 바로 실행하지 않고 <code class=\"language-text\">import</code>/<code class=\"language-text\">export</code> 구문을 찾아서 스크립트를 파싱한다. 그리고 더 이상 import 것이 없어질 때까지 import를 찾은 다음 dependencies의 모듈 그래프를 만들어 낸다.</p>\n</blockquote>\n<hr>\n<p><strong>✔️ Ref</strong>\n<a href=\"https://webpack.kr/guides/production/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://webpack.kr/guides/production/</a>\n<a href=\"https://ui.toast.com/weekly-pick/ko_20191212\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://ui.toast.com/weekly-pick/ko_20191212</a>\n<a href=\"https://github.com/browserslist/browserslist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/browserslist/browserslist</a>\n<a href=\"https://webpack.js.org/guides/asset-modules/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://webpack.js.org/guides/asset-modules/</a>\n<a href=\"https://webpack.js.org/plugins/define-plugin/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://webpack.js.org/plugins/define-plugin/</a>\n<a href=\"https://www.debugbear.com/blog/bundle-splitting-components-with-webpack-and-react\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.debugbear.com/blog/bundle-splitting-components-with-webpack-and-react</a>\n<a href=\"https://github.com/styled-components/styled-components/issues/2254#issuecomment-560027361\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/styled-components/styled-components/issues/2254#issuecomment-560027361</a>\n<a href=\"https://medium.com/naver-fe-platform/webpack%EC%97%90%EC%84%9C-tree-shaking-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0-1748e0e0c365\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://medium.com/naver-fe-platform/webpack에서-tree-shaking-적용하기-1748e0e0c365</a>\n<a href=\"https://webpack.js.org/configuration/optimization/#optimizationsideeffects\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://webpack.js.org/configuration/optimization/#optimizationsideeffects</a>\n<a href=\"https://redfin.engineering/node-modules-at-war-why-commonjs-and-es-modules-cant-get-along-9617135eeca1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://redfin.engineering/node-modules-at-war-why-commonjs-and-es-modules-cant-get-along-9617135eeca1</a></p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"></code></pre></div>","timeToRead":6,"frontmatter":{"title":"webpack 설정 뜯어보기","date":"September 11, 2021","description":null,"tags":["frontend","webpack"],"disqus":null},"fields":{"langKey":"en"}}},"pageContext":{"slug":"/frontend/webpack-config/","previous":{"fields":{"slug":"/wtc/wtc-week-31/","langKey":"en","directoryName":"wtc"},"frontmatter":{"date":"September 11, 2021","description":null,"title":"우테코 31주차 기록","tags":["woowacourse"]}},"next":{"fields":{"slug":"/frontend/babel-almost/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"September 05, 2021","description":null,"title":"Babel의 (조금) 모든 것","tags":["frontend"]}},"previousInSameTag":{"fields":{"slug":"/frontend/web-server-was/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"September 12, 2021","description":null,"title":"Web Server와 WAS 간단 정리","tags":["frontend"]}},"nextInSameTag":{"fields":{"slug":"/frontend/babel-almost/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"September 05, 2021","description":null,"title":"Babel의 (조금) 모든 것","tags":["frontend"]}},"translationsLink":[]}},"staticQueryHashes":["1522010811","2466007692","2894998521","3765107650","683610688"]}