{"componentChunkName":"component---src-templates-blog-post-js","path":"/frontend/s3-cloudfront/","result":{"data":{"site":{"siteMetadata":{"title":"ziglog","author":"zigsong","lang":"en"}},"markdownRemark":{"id":"e64920c1-684b-5279-98ef-4cf4505d2bcb","excerpt":"React App s3 & Cloudfront로 배포하기 리액트로 만든 앱을 s3와 Cloudfront를 이용해 배포해 보자! 1. s3 bucket 생성 s3 bucket을 생성하고, 모든 퍼블릭 액세스를 차단해준다. 이후 생성할 cloudfront…","html":"<p>React App s3 &#x26; Cloudfront로 배포하기</p>\n<!-- more -->\n<p>리액트로 만든 앱을 s3와 Cloudfront를 이용해 배포해 보자!</p>\n<h3 id=\"1-s3-bucket-생성\" style=\"position:relative;\"><a href=\"#1-s3-bucket-%EC%83%9D%EC%84%B1\" aria-label=\"1 s3 bucket 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. s3 bucket 생성</h3>\n<p>s3 bucket을 생성하고, 모든 퍼블릭 액세스를 차단해준다. 이후 생성할 cloudfront에서만 해당 버킷으로 접근이 가능하도록 설정해줄 것이다.</p>\n<img src=\"01.png\" />\n<h3 id=\"필요-시-2-정적-웹-사이트-호스팅-활성화\" style=\"position:relative;\"><a href=\"#%ED%95%84%EC%9A%94-%EC%8B%9C-2-%EC%A0%95%EC%A0%81-%EC%9B%B9-%EC%82%AC%EC%9D%B4%ED%8A%B8-%ED%98%B8%EC%8A%A4%ED%8C%85-%ED%99%9C%EC%84%B1%ED%99%94\" aria-label=\"필요 시 2 정적 웹 사이트 호스팅 활성화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(필요 시) 2. 정적 웹 사이트 호스팅 활성화</h3>\n<p>s3 버킷의 [속성]에서 정적 웹 사이트 호스팅을 활성화 해준다. 사실 cloudfront를 이용하여 정적 웹 사이트를 호스팅할 경우 필요하지 않은 부분이다. cloudfront를 이용하지 않고 s3 버킷의 도메인을 이용해서 정적 웹 사이트 호스팅을 해준다면 정적 웹 사이트 호스팅을 활성화해준다. 이때 도메인 접속을 위해 퍼블릭 액세스 차단을 모두 해제하거나 버킷 정책을 따로 만들어 설정해줘야 한다.</p>\n<img src=\"02.png\" />\n<h3 id=\"3-빌드-후-번들-파일-업로드\" style=\"position:relative;\"><a href=\"#3-%EB%B9%8C%EB%93%9C-%ED%9B%84-%EB%B2%88%EB%93%A4-%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C\" aria-label=\"3 빌드 후 번들 파일 업로드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 빌드 후 번들 파일 업로드</h3>\n<p><code class=\"language-text\">yarn build</code> 후 생성된 <code class=\"language-text\">dist</code> 폴더 안의 파일들을 업로드해준다.</p>\n<img src=\"03.png\" />\n<h3 id=\"4-cloudfront-distribution-생성\" style=\"position:relative;\"><a href=\"#4-cloudfront-distribution-%EC%83%9D%EC%84%B1\" aria-label=\"4 cloudfront distribution 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Cloudfront distribution 생성</h3>\n<p>cloudfront를 통해 방금 만든 s3 버킷에 접근해보자. 우측 [배포 생성] 버튼을 누른다.</p>\n<img src=\"04.png\" />\n<p>원본 오리진으로 앞서 만든 s3 버킷을 선택해주고, 새 OAI를 생성한다.</p>\n<p>OAI는 Origin Access Identity의 약자로, CloudFront에서 OAI를 사용하여 버킷의 파일을 액세스해 사용자에게 제공할 수 있도록 S3 버킷 권한을 구성할 수 있다.</p>\n<img src=\"05.png\" width=\"560px\" />\n<p>그러면 현재 cloudfront에 연결된 s3 버킷에 자동으로 버킷 정책이 추가된다.</p>\n<img src=\"06.png\" />\n<p>자동 객체 압축은 Yes로, 뷰어 프로토콜 정책은 Redirect HTTP to HTTPS로 설정해 준다. (cloudfront에서 제공하는 기본 보안 정책이다.)</p>\n<img src=\"07.png\" width=\"560px\" />\n<h3 id=\"5-캐시-정책-설정\" style=\"position:relative;\"><a href=\"#5-%EC%BA%90%EC%8B%9C-%EC%A0%95%EC%B1%85-%EC%84%A4%EC%A0%95\" aria-label=\"5 캐시 정책 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 캐시 정책 설정</h3>\n<p>cloudfront는 aws에서 제공하는 CDN으로, 오리진 서버까지 가지 않고 리소스를 가져오는 캐시 기능을 사용할 수 있다. 기본으로 제공되는 CachingOptimized를 선택해주었다.</p>\n<img src=\"08.png\" />\n<p>이렇게 하면 cloudfront 기본 설정은 끝난다. [확인] 버튼을 눌러준다.</p>\n<h3 id=\"6-기본-객체-루트-및-오류-페이지-응답-편집\" style=\"position:relative;\"><a href=\"#6-%EA%B8%B0%EB%B3%B8-%EA%B0%9D%EC%B2%B4-%EB%A3%A8%ED%8A%B8-%EB%B0%8F-%EC%98%A4%EB%A5%98-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%9D%91%EB%8B%B5-%ED%8E%B8%EC%A7%91\" aria-label=\"6 기본 객체 루트 및 오류 페이지 응답 편집 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 기본 객체 루트 및 오류 페이지 응답 편집</h3>\n<p>cloudfront 대시보드의 일반 → 설정 → 편집에서 기본값 루트 객체를 리액트 앱의 진입점인 <code class=\"language-text\">index.html</code>로 설정해 준다.</p>\n<img src=\"09.png\" />\n<img src=\"09-1.png\" />\n<p>마지막으로 cloudfront 대시보드의 [오류 페이지] 탭에서 오류 시 돌아갈 응답 페이지를 입력해준다. (react로 SPA 개발 시 router를 사용한다면 체크해줘야 할 부분이다.)</p>\n<img src=\"10.png\" />\n<h3 id=\"7-확인\" style=\"position:relative;\"><a href=\"#7-%ED%99%95%EC%9D%B8\" aria-label=\"7 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. 확인!</h3>\n<p>이제 cloudfront 도메인을 통해 사이트를 확인할 수 있다 👾</p>","timeToRead":2,"frontmatter":{"title":"React App s3 & Cloudfront로 배포하기","date":"August 28, 2021","description":null,"tags":["aws","frontend"],"disqus":null},"fields":{"langKey":"en"}}},"pageContext":{"slug":"/frontend/s3-cloudfront/","previous":{"fields":{"slug":"/frontend/fe-performance-basecamp/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"August 28, 2021","description":null,"title":"프론트엔드 성능 베이스캠프","tags":["frontend"]}},"next":{"fields":{"slug":"/wtc/wtc-week-29/","langKey":"en","directoryName":"wtc"},"frontmatter":{"date":"August 28, 2021","description":null,"title":"우테코 29주차 기록","tags":["woowacourse"]}},"previousInSameTag":{"fields":{"slug":"/frontend/fe-performance-basecamp/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"August 28, 2021","description":null,"title":"프론트엔드 성능 베이스캠프","tags":["frontend"]}},"nextInSameTag":{"fields":{"slug":"/frontend/fe-performance-measurement/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"August 14, 2021","description":null,"title":"프론트엔드 성능 분석 & 기본 성능 개선","tags":["frontend"]}},"translationsLink":[]}},"staticQueryHashes":["1522010811","1615650028","2894998521","3765107650","683610688"]}