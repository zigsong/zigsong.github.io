{"componentChunkName":"component---src-templates-blog-post-js","path":"/frontend/ec2-next/","result":{"data":{"site":{"siteMetadata":{"title":"ziglog","author":"zigsong","lang":"en"}},"markdownRemark":{"id":"25943b01-ad5b-5659-bade-209a055eaa15","excerpt":"EC2 | Next.js | Node.js | pm2 | nginx SSR을 사용하는 next.js 앱을 EC2에 배포하려다가 이것도 하고 저것도 하고… 결국 주말 하루를 꼬박 날리고야 만 대장정을 시작해보려고 한다. 1. AWS 인스턴스 생성 aws 계정에 로그인한 후, EC…","html":"<p>EC2 | Next.js | Node.js | pm2 | nginx</p>\n<!-- more -->\n<p>SSR을 사용하는 next.js 앱을 EC2에 배포하려다가 이것도 하고 저것도 하고… 결국 주말 하루를 꼬박 날리고야 만 대장정을 시작해보려고 한다.</p>\n<hr>\n<h2 id=\"1-aws-인스턴스-생성\" style=\"position:relative;\"><a href=\"#1-aws-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%83%9D%EC%84%B1\" aria-label=\"1 aws 인스턴스 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. AWS 인스턴스 생성</h2>\n<p>aws 계정에 로그인한 후, EC2 대시보드에 들어가 우측 상단의 [인스턴스 시작] 버튼을 누른다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e41b64081593c18e5eee14b604cc1292/8201f/01.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 25.675675675675674%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwElEQVQY052MQW+DMAxG+fu7T9pp511WKE1LYdtfIi6hYRBTXpVAJ+02LdLTZzvPzt4PNfnhzNvOkJuG3NQpC9NQVp+Y+ov9qaE41pTVB/tjpEkUpmZXVslvXp85vzyRsT3pr4j/TrjBM44jYZ5QDWgIzLMyTRNhq2FhWW7pP84WnQhDTzb4axJFBCsX7CWy1q1YWhFaK2tuWBEketF/9J3Ddh2Z9x5VpXMO1/f/Zt13ZEEVneefgzH/gnO/3cfuHXC/cdiKtYDbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"01\" title=\"01\" src=\"/static/e41b64081593c18e5eee14b604cc1292/fcda8/01.png\" srcset=\"/static/e41b64081593c18e5eee14b604cc1292/12f09/01.png 148w,\n/static/e41b64081593c18e5eee14b604cc1292/e4a3f/01.png 295w,\n/static/e41b64081593c18e5eee14b604cc1292/fcda8/01.png 590w,\n/static/e41b64081593c18e5eee14b604cc1292/efc66/01.png 885w,\n/static/e41b64081593c18e5eee14b604cc1292/c83ae/01.png 1180w,\n/static/e41b64081593c18e5eee14b604cc1292/8201f/01.png 2554w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3 id=\"-단계-1-ami-선택\" style=\"position:relative;\"><a href=\"#-%EB%8B%A8%EA%B3%84-1-ami-%EC%84%A0%ED%83%9D\" aria-label=\" 단계 1 ami 선택 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 단계 1: AMI 선택</h3>\n<p>AMI가 뭘까? (<del>아미?</del> 🔫)</p>\n<p>AMI는 Amazon Machine Image의 약자로, 인스턴스를 시작하는 데 필요한 정보를 제공한다. EC2 인스턴스와 같은 가상 서버들을 생성하는 데 필요한 마스터 이미지, 즉 운영체제에 필요한 템플릿을 캡쳐해 놓은 스냅샷 이미지와 같다.</p>\n<p>호스팅 컴퓨터로 Ubuntu 18.04 버전의 SSD Volume type을 선택한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/41ed9eb850752f66a1731e4e665a5e76/6dbe2/02.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 35.810810810810814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNElEQVQoz33Q64rUQBCG4dz/DXkF/vOIIgrLrJOZnDrpQ7qT9CHpfmVm1WVALHioon4UfFUZJVFKIaXEWksI4S6lRIzxoZdS/mvPhcoYzbIsrKtj2zzruuJDwPsXm/fElNiPg/yPI7fdrZxPPA+Oqm1bRiHorzVyGhF9j1GKWWusMfd5dY49RvKxQ86UfLw6DqCgrefzaaLSZma8nLl++4LpGuTlzNw12L77rWWbBKzuriz2QV4sbA4lFO8/PN0iG5QYaE5PjM0VcalRXYsbBfaPSRDtTN5WiP5R8LAHtLK8+1q//FBMktPPGqUkwy3+KJGzY/ERu4V79/uBTwdhz4+OQsoFtSR+tJZKa82kZz6dFW8+Nrz93lOPM7XcGFx8ZSPd7P/q50BvA4NL9DYiXERtO78AI5gZOinM+ucAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"02\" title=\"02\" src=\"/static/41ed9eb850752f66a1731e4e665a5e76/fcda8/02.png\" srcset=\"/static/41ed9eb850752f66a1731e4e665a5e76/12f09/02.png 148w,\n/static/41ed9eb850752f66a1731e4e665a5e76/e4a3f/02.png 295w,\n/static/41ed9eb850752f66a1731e4e665a5e76/fcda8/02.png 590w,\n/static/41ed9eb850752f66a1731e4e665a5e76/efc66/02.png 885w,\n/static/41ed9eb850752f66a1731e4e665a5e76/c83ae/02.png 1180w,\n/static/41ed9eb850752f66a1731e4e665a5e76/6dbe2/02.png 2527w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<blockquote>\n<p>👾 <strong>SSD란?</strong>\nSolid State Disk의 약자로, 보조기억장치를 가리킨다.\n(그냥 궁금해서)</p>\n</blockquote>\n<h3 id=\"-단계-2-인스턴스-유형-선택\" style=\"position:relative;\"><a href=\"#-%EB%8B%A8%EA%B3%84-2-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%9C%A0%ED%98%95-%EC%84%A0%ED%83%9D\" aria-label=\" 단계 2 인스턴스 유형 선택 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 단계 2: 인스턴스 유형 선택</h3>\n<p><del>현재 테크코스의 계정으로 내 돈은 아니지만</del>, 아무튼 간에 t2.micro 또는 t2.medium을 선택한다. 프리티어 이용 시 t2.micro만 사용 가능하다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/128db01f36cd3550e9089e08f292aa1e/900ee/03.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 16.216216216216214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAg0lEQVQI102KSQ6DMBAE+f9HgwBjvM7m0JGHRMqh1Itq2bcN67riPANSLlARiDCYyTtRfzaR99839+MxVBXDDKaKJVwFV26IqTqvsOMqDal05EqIuT6ZKo4zoXR2fzJ7iNmZ/nQWkgEdN8TenkeKIDGoze/72+1faeTOP6UxamfvrAMfD9jonnYs74IAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"03\" title=\"03\" src=\"/static/128db01f36cd3550e9089e08f292aa1e/fcda8/03.png\" srcset=\"/static/128db01f36cd3550e9089e08f292aa1e/12f09/03.png 148w,\n/static/128db01f36cd3550e9089e08f292aa1e/e4a3f/03.png 295w,\n/static/128db01f36cd3550e9089e08f292aa1e/fcda8/03.png 590w,\n/static/128db01f36cd3550e9089e08f292aa1e/efc66/03.png 885w,\n/static/128db01f36cd3550e9089e08f292aa1e/c83ae/03.png 1180w,\n/static/128db01f36cd3550e9089e08f292aa1e/900ee/03.png 2544w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3 id=\"-단계-3-인스턴스-세부-정보-구성\" style=\"position:relative;\"><a href=\"#-%EB%8B%A8%EA%B3%84-3-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%84%B8%EB%B6%80-%EC%A0%95%EB%B3%B4-%EA%B5%AC%EC%84%B1\" aria-label=\" 단계 3 인스턴스 세부 정보 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 단계 3: 인스턴스 세부 정보 구성</h3>\n<p>VPC와 서브넷을 선택하고, 퍼블릭 IP를 활성화해준다. (노출되어도 상관없는 정보라고 믿어본다…)</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b9b6309de2b0a6a85376ba02320459b3/71e8d/04.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVQ4y5WTjY7bIBCE8/7PV/WktLlUiS82NnaMgTX476sgzalXpdd0pZFBeIfZnWVXVRVKKcpKcS4KGt3iZcR5wYlwHSydcRhrGazFe0G8ZxgGnHN477HWEmMkxW7bNhKid/S6YfIeMT3jYJhHQZzgrDCJZwsj6zyxrCvLsnzAuq4Zuw3Y+pat0zSHb4S6oty/UHz9QnPY0x6/4y9n7KWgvyhmVWYldyF/YpcP25oggvVCiJFLWVGpmvZ65WoMXd8TphmZNpZG8YuRR3FTaK7405F6/0IoC/ofB+zpSKzeWLRiUhdWraCrQVfknHV9rPC2ABGhVoowjnRdl5s+iuR9MiGdj3FhXra/lvsb4ZYTtNaEEOhTiSFk5xKSk9fe0AwRiXPS92/ClHQnNMZgncsqE9Jl8zx/asYHU5LddV1zOp2YpgmtG9J8GnNT+j+RFd7DO0cIkUNR81rUvFVNHvI5zd6yvCv8tOT7T6m0ZEaME+dKcy4bSqWRMbwP7VMl3xdJQepj6lU7CDasrBtPkTwkTETJjPTtB5thJbm65Kf2LOFPfz71pQPyTpoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"04\" title=\"04\" src=\"/static/b9b6309de2b0a6a85376ba02320459b3/fcda8/04.png\" srcset=\"/static/b9b6309de2b0a6a85376ba02320459b3/12f09/04.png 148w,\n/static/b9b6309de2b0a6a85376ba02320459b3/e4a3f/04.png 295w,\n/static/b9b6309de2b0a6a85376ba02320459b3/fcda8/04.png 590w,\n/static/b9b6309de2b0a6a85376ba02320459b3/efc66/04.png 885w,\n/static/b9b6309de2b0a6a85376ba02320459b3/c83ae/04.png 1180w,\n/static/b9b6309de2b0a6a85376ba02320459b3/71e8d/04.png 1304w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p><strong>VPC</strong>란 Virtual Private Cloud의 약자로, 사용자의 AWS 계정 전용 가상 네트워크다. VPC가 없다면 수많은 EC2 인스턴스들이 서로 거미줄처럼 연결되고 인터넷과 연결되어 복잡도를 증가시킬 것이다.\nVPC를 적용하여 VPC별로 네트워크를 구성하고, 독립적으로 네트워크 설정을 줄 수 있다. 또, VPC를 사용하면 리소스 배치, 연결 및 보안을 포함하여 가상 네트워킹 환경을 제어할 수 있다</p>\n<p><strong>서브넷</strong>은 VPC의 IP 주소 범위를 가리킨다. VPC 내부의, VPC보다 더 작은 단위를 가리킨다. 더 많은 네트워크망을 만들기 위해 서브넷을 사용한다.</p>\n<p>VPC와 서브넷은 아래와 같은 구조로 이루어져 있다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/69b858f5913e674024a6f3e8508b84ae/10ab7/05.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVQoz22Ry27TQBSG89bwBrwAYsEaCYkFrFggloiLqFS1KojWudiO7bHj2I49notjx/nQuGlA0CN9c3Q0Z/4588/s+8Ulnz5/xYVsFUoblNYTWptHmXrUnx5ju4nD4cDs9Zt3PHn6jPldhNGapmmQUtK2LXUj2dUN9V+4umkkqm2RsmW32yGEwPcDojhh5iZ7//aCVy+/4Ec5adYwXwruvIiyaNFtj5LdGd3uKUvFfJUishpvkXB943F16bFaRcy0MSRRyrcfCS8+XrPdFiwXHmJbIc1+smIcR8bxyOEwTvU8rXj+4YpNucO7/UleFMxXWwI/ZmasJVoLgqSmND1dlWAyD6Mkpr8XOB6Pbj1l2GlL2nQMqkQlv+hlxmpd4rsJnWAYCtJNOzUPnaKIF5R1Q1lLOmtwrzDmPltrqJyHWmONZitChr5jGWzx/ZPgOhSITOLut7sMU6ynw3o/nCd8wIXqemw/cuwtKluylznLsPxH8DShrrdUYoHtB+xw4LEw/YBz4zh0bFY36DrDjyoC//Qpzsw4rhF5Q5TWhEnFOq0pSoVuO1ppz7i6rBRRVpNsGpZhTrypub0TrJZrZvt9T7iOESInjjKS2LEhjrOJKPqfhz2HSPKJIEjI84LfkUvxla676wAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"05\" title=\"05\" src=\"/static/69b858f5913e674024a6f3e8508b84ae/fcda8/05.png\" srcset=\"/static/69b858f5913e674024a6f3e8508b84ae/12f09/05.png 148w,\n/static/69b858f5913e674024a6f3e8508b84ae/e4a3f/05.png 295w,\n/static/69b858f5913e674024a6f3e8508b84ae/fcda8/05.png 590w,\n/static/69b858f5913e674024a6f3e8508b84ae/efc66/05.png 885w,\n/static/69b858f5913e674024a6f3e8508b84ae/c83ae/05.png 1180w,\n/static/69b858f5913e674024a6f3e8508b84ae/10ab7/05.png 1552w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<blockquote>\n<p>👾 <strong>EC2? VPC?</strong></p>\n<p>EC2는 computing service, VPC는 Virtual Private Cloud\nEC2는 VPC의 일부이며 EC2 인스턴스에 접근을 위해서는 VPC가 필요하다.</p>\n</blockquote>\n<blockquote>\n<p>👾 <strong>public IP vs private IP</strong></p>\n<p><strong>퍼블릭 IP 주소</strong>는 인터넷을 통해 연결할 수 있는 IPv4 주소이다. 퍼블릭 주소는 인스턴스와 인터넷의 상호 통신을 위해 사용된다. 또한, 퍼블릭 IP 주소가 할당된 각 인스턴스에는 외부 DNS 호스트이름이 할당된다.</p>\n<p><strong>프라이빗 IP 주소</strong>는 인터넷을 통해 연결할 수 없는 IP 주소이다. 프라이빗 IPv4 주소는 동일 VPC에서 인스턴스 간의 통신을 위해 사용될 수 있다. 즉 우리끼리, 내부 네트워크 내에서 위치를 찾아갈 때 사용한다. 이때 각각의 VPC는 완전히 독립적이기 때문에 VPC간 통신을 위한다면 VPC 피어링 서비스를 고려해볼 수 있다.</p>\n</blockquote>\n<h3 id=\"-단계-4-스토리지-추가\" style=\"position:relative;\"><a href=\"#-%EB%8B%A8%EA%B3%84-4-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80-%EC%B6%94%EA%B0%80\" aria-label=\" 단계 4 스토리지 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 단계 4: 스토리지 추가</h3>\n<p>원하는 볼륨 크기를 설정한다. EC2의 하드디스크 용량을 설정하는 것이다. (30GiB 이상을 권장한다. 하지만 그냥 기본값으로 하고 넘어갔다. 내 돈이 아니니까…💸)</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/8e981b5172237549d523e4a950774c64/f2b95/06.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVQY03WQi4qDQAxF/f+v3Go7dkfnPYm1VU9xYBeWpYFDXnDJTTeOIye1VpZFkexZpKCqv4goVZR1XRv7vvMpOmNOwTvX6xVjDJdLj7UTwzC0Wd/3fA0j1kVyzszzzDRNWGsJIRJCaJRSEBG6RbVdllNCRXBuJsVIybn1KUVm+82igtRCCB7vXRMNqVJKxTvXRE+Xnc+CPndk3aiPV8t/2du8PjbqerBs8Dr4bPkelTEIxldurrT6p2+7qK02QbilJ5Ns5Mf5w4Pj+M8bWDSA4Aowja4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"06\" title=\"06\" src=\"/static/8e981b5172237549d523e4a950774c64/fcda8/06.png\" srcset=\"/static/8e981b5172237549d523e4a950774c64/12f09/06.png 148w,\n/static/8e981b5172237549d523e4a950774c64/e4a3f/06.png 295w,\n/static/8e981b5172237549d523e4a950774c64/fcda8/06.png 590w,\n/static/8e981b5172237549d523e4a950774c64/efc66/06.png 885w,\n/static/8e981b5172237549d523e4a950774c64/c83ae/06.png 1180w,\n/static/8e981b5172237549d523e4a950774c64/f2b95/06.png 1515w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3 id=\"-단계-5-태그-추가\" style=\"position:relative;\"><a href=\"#-%EB%8B%A8%EA%B3%84-5-%ED%83%9C%EA%B7%B8-%EC%B6%94%EA%B0%80\" aria-label=\" 단계 5 태그 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 단계 5: 태그 추가</h3>\n<p>다른 사람의 서버와 구분할 수 있도록 <code class=\"language-text\">Name</code> 태그를 붙여준다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/951e254576005cc4f213f50cd8815b85/60a48/07.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 24.324324324324326%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuklEQVQY052Q6wqDMAyFff9n3AZatbXqqLe2ptUzEpH9HCzw0aSBk5wUVVVBKQXnnDDPM5ZlwbquWNYN23bhvcd5nvgVhdYabdvifvu+xzxNeLsJ4+QRYgTRDiJCzllIREgpCVzv+9XngSLIIuM4YhgGyZmmaVArBWs7WGuFrutgjEFZKbRaQ9UNtDF4PF8oy1JcFWwzhCCWYowCT2TrDOf3H+PjjkAHKB2IDGVQhrjgvgjyusz/8b3tBzwKgrjmI3Q6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"07\" title=\"07\" src=\"/static/951e254576005cc4f213f50cd8815b85/fcda8/07.png\" srcset=\"/static/951e254576005cc4f213f50cd8815b85/12f09/07.png 148w,\n/static/951e254576005cc4f213f50cd8815b85/e4a3f/07.png 295w,\n/static/951e254576005cc4f213f50cd8815b85/fcda8/07.png 590w,\n/static/951e254576005cc4f213f50cd8815b85/efc66/07.png 885w,\n/static/951e254576005cc4f213f50cd8815b85/c83ae/07.png 1180w,\n/static/951e254576005cc4f213f50cd8815b85/60a48/07.png 1325w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3 id=\"-단계-6-보안-그룹-구성\" style=\"position:relative;\"><a href=\"#-%EB%8B%A8%EA%B3%84-6-%EB%B3%B4%EC%95%88-%EA%B7%B8%EB%A3%B9-%EA%B5%AC%EC%84%B1\" aria-label=\" 단계 6 보안 그룹 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 단계 6: 보안 그룹 구성</h3>\n<p>보안 그룹 설정을 통해 EC2 인스턴스로 들어오고 나가는 트래픽을 세부적으로 제어할 수 있다.\nex) SSH 접속 포트는 22번, 서비스 기본 포트는 80번</p>\n<p>현재 본인 소유의 계정이 아니므로, 새로 만들지 않고 기존의 보안 그룹을 선택해주었다.</p>\n<ul>\n<li>인바운드 - 외부에서 인스턴스로 들어오는 요청</li>\n<li>아웃바운드 - 인스턴스에서 외부로 나가는 트래픽</li>\n</ul>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a75c21f972f87f19e9445f9e0c58a00d/742d3/08.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 18.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0ElEQVQY013KMUpDURCF4dmBhYW9CpZZgIWdrVEEs4SUiYjuSTAxdpJEN2Cb1spORDC+d+feO3d+ee8JEouPOZwzUtInbl9AAOrfGwH956/LOaIaiXFTyhm5myu3j2sm84qH58h0EZgstDVdKrOnzv0ytJr8/qGkpISgBFVUlaqqWyI7BTlwZN+R3SYXtg4L20cF6ZWu29v0sjLASMkwM7wUvkNiXSfkeOicXTr9cQNOx87FtTO4gfMr6I9o+2Y/GXV/r28OOGaOu4M7MRuajB8PTgxSV9IaqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"08\" title=\"08\" src=\"/static/a75c21f972f87f19e9445f9e0c58a00d/fcda8/08.png\" srcset=\"/static/a75c21f972f87f19e9445f9e0c58a00d/12f09/08.png 148w,\n/static/a75c21f972f87f19e9445f9e0c58a00d/e4a3f/08.png 295w,\n/static/a75c21f972f87f19e9445f9e0c58a00d/fcda8/08.png 590w,\n/static/a75c21f972f87f19e9445f9e0c58a00d/efc66/08.png 885w,\n/static/a75c21f972f87f19e9445f9e0c58a00d/c83ae/08.png 1180w,\n/static/a75c21f972f87f19e9445f9e0c58a00d/742d3/08.png 2550w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h3 id=\"-단계-7-인스턴스-시작-검토\" style=\"position:relative;\"><a href=\"#-%EB%8B%A8%EA%B3%84-7-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%8B%9C%EC%9E%91-%EA%B2%80%ED%86%A0\" aria-label=\" 단계 7 인스턴스 시작 검토 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✅ 단계 7: 인스턴스 시작 검토</h3>\n<p>앞의 모든 단계 설정을 마무리했다면, 우측 하단의 [검토 및 시작]을 눌러 이전 단계의 설정들을 확인한 후, 키페어를 생성한다.</p>\n<p>이 키페어는 SSH로 접속 시 필요한 키로, 한번 발급 받은 후 분실하면 다시 찾을 수 없으니 잘 보관해두자! 🔑\n(<code class=\"language-text\">.pem</code> 파일 형식으로 생성된다)</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/68af7b14b2a02fe348d7e04197210d67/bbb77/09.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACf0lEQVQ4y52Ua2/TSBSG8///ASAk0Epb+ALsdmlpC5SLFj4gtm3aOM7FzrWpk9ROfLfHHj+rmVxooXyAkR69M2fG75xzbLm2f3TMwZv3W169fsfB2w+3Ytv4d7FN/Oj4I893X/Hwj6fU+v0+hmFgGA3Oz8+p1+vYtqVjjcYFZ2enzGczoigk8H2CwMdf62od4Lku/52e8eDxE2qe5+G6LvP5nNlspplOp3q9ial9hTqrUIaLxWK7TpKE+oXBg8c71NTDKrNOp6Npt9vbtW3b9Ho9TNOk2WzqWLdradQ5y7JoNBq47jUdq8f9R3+uDNXBwWDAaDRiMploEzUfj8c6PhwO1/M+PdvC6nbwPJc4jnSmWZbR6ljcVxnGcaz7EIahJooiraqs5XK5nase+nGOG+b4sSDOK8KsIowzKilpd+1VhuoGlZEqz3Ec0jTdmipVF2qNIqJkZRYmgigVBInADyLKovhmWJYlV46je+K6HkVRIIT4CTmFyLWKfKUqATW2hqKQNK0xRuNCfx6qL78zdA8f7SjDgp4T0B65TLycq6XgaiFu6x2M5gmDWUR/GhJk0L5puBlFWa2QNyhvI8qKUsJwdEnDMDFbXWR1o2SQfGwteW8usNyM1izFcBKaToI5TeleZzTXqvZsN9fanqWYa5VAp7vOsCwLTCflsx3wr+Xzyfb5Ooz4Mgg5GUWcTxJOx5HmZBxRv4zpeTnDpeDSF0x8sX4pm5LFpuSKqvoRKSVVJZEbpKSUkjgvsK9VJSGLrKKjS96hVqx7eJfZXaiLVR8dP+e4NefvswnteYpl2dxTPXzx8oC/Xh7+GnuH7O4fsrt3yD/7iiOePtvVv6//AT4alKmqfstgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"09\" title=\"09\" src=\"/static/68af7b14b2a02fe348d7e04197210d67/fcda8/09.png\" srcset=\"/static/68af7b14b2a02fe348d7e04197210d67/12f09/09.png 148w,\n/static/68af7b14b2a02fe348d7e04197210d67/e4a3f/09.png 295w,\n/static/68af7b14b2a02fe348d7e04197210d67/fcda8/09.png 590w,\n/static/68af7b14b2a02fe348d7e04197210d67/bbb77/09.png 765w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>기본적으로 RSA 방식으로 암호화된 공개키-비밀키 형식의 키페어를 제공하지만, 올해 8월부터 제공하는 ED25519 방식의 키페어를 발급 받으면 더욱 높은 수준의 보안 시스템을 이용할 수 있다고 한다.</p>\n<p>클라이언트의 SSH에서 AWS EC2 인스턴스에 접속할 때 키페어는 다음과 같은 과정을 통해 교환된다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c51c912e2707146ba55c8f4851d83f75/c0255/10.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 29.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVQY031Ry46CQBDk/3/DxKsH9eCBoCHRcJIQHgMMD0GUBRkCepC4Wpvu7F53kkp3pqtrunq0MAxh2zaiKMLr9Y3n84nH44FxHP/F/X5nHsUgCJBmGZqmgabrOna7HSimaYphGHDKT4jCEEIESJKE72UcI8sySCkhhGCB6/XKfBpou90iz3NojuOADhWPxyNutxvnSvVQXYc4jkEuSNinSdIMXdcxiFfXNRaLBWazGfb7PbTVaoXD4YDNZgPf96GUYtLlcmGUZYlTUaD4xflccZ2g+p5Fl8slSMeyLGiGYcA0TazXa7ZG+6Fd0GRChGyRcikTJInkSck+2WvblgWpdz6fg9xqn88Hf2eaJn65ab642fM8thsIwXsjB67rwnU95lVVhb7v8X6/+TNJ6wcFA7DHUkwCUwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"10\" title=\"10\" src=\"/static/c51c912e2707146ba55c8f4851d83f75/fcda8/10.png\" srcset=\"/static/c51c912e2707146ba55c8f4851d83f75/12f09/10.png 148w,\n/static/c51c912e2707146ba55c8f4851d83f75/e4a3f/10.png 295w,\n/static/c51c912e2707146ba55c8f4851d83f75/fcda8/10.png 590w,\n/static/c51c912e2707146ba55c8f4851d83f75/efc66/10.png 885w,\n/static/c51c912e2707146ba55c8f4851d83f75/c0255/10.png 920w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이렇게 EC2 인스턴스가 생성되었다! <del>고작</del> 첫 번째 단계가 끝났다 😑</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/08aef43a00d32e60d66dead0b3544d3b/f5aa5/11.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 11.486486486486488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZ0lEQVQI1y2KQQ7DIAwE8/9H9tZUKV5jwGBy2grSw2hmpT3OBF5WeeXKrxVarXTvjBmMeJhzcoyxe/m+783a7k7vnYE32+fFQ1WZACY1ioKCPyqPBcT6iOxezma0Uqg5E9DtNoIojT9xnJih1uCDFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"11\" title=\"11\" src=\"/static/08aef43a00d32e60d66dead0b3544d3b/fcda8/11.png\" srcset=\"/static/08aef43a00d32e60d66dead0b3544d3b/12f09/11.png 148w,\n/static/08aef43a00d32e60d66dead0b3544d3b/e4a3f/11.png 295w,\n/static/08aef43a00d32e60d66dead0b3544d3b/fcda8/11.png 590w,\n/static/08aef43a00d32e60d66dead0b3544d3b/efc66/11.png 885w,\n/static/08aef43a00d32e60d66dead0b3544d3b/c83ae/11.png 1180w,\n/static/08aef43a00d32e60d66dead0b3544d3b/f5aa5/11.png 2312w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<hr>\n<h2 id=\"2-ssh-접속\" style=\"position:relative;\"><a href=\"#2-ssh-%EC%A0%91%EC%86%8D\" aria-label=\"2 ssh 접속 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. SSH 접속</h2>\n<p>방금 만든 인스턴스를 클릭하고, [연결] 버튼을 눌러준다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/592e0aa2938718f29ac9d5d74a521e28/03d1d/12.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAl0lEQVQY02WNi2oDMQwE7/+/tFDicr7TyXp5Spy0pcnCgGDZ0dbaF7dbY993eu+ICJcq5r5uNSMifslMVHWRVYQZ9vnBEMHM2dboLngOf+LhdDlI3nOK0PuxNmMMRhb17LZDBFHjGk5mwZyruMvP1gg5mG7M8MXjWVD1UMw5/7GJDsST05Kqv6IySb3ISygbVPjiVfAq/AYK0DoqsjSZZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"12\" title=\"12\" src=\"/static/592e0aa2938718f29ac9d5d74a521e28/fcda8/12.png\" srcset=\"/static/592e0aa2938718f29ac9d5d74a521e28/12f09/12.png 148w,\n/static/592e0aa2938718f29ac9d5d74a521e28/e4a3f/12.png 295w,\n/static/592e0aa2938718f29ac9d5d74a521e28/fcda8/12.png 590w,\n/static/592e0aa2938718f29ac9d5d74a521e28/efc66/12.png 885w,\n/static/592e0aa2938718f29ac9d5d74a521e28/c83ae/12.png 1180w,\n/static/592e0aa2938718f29ac9d5d74a521e28/03d1d/12.png 2265w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>그러면 다음과 같이 친절하게 SSH 연결을 위한 커맨드를 알려준다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1e5c740e8db1951756a949dac298183e/bad1b/13.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCElEQVQ4y5WUiY6jMAyG+/5Pt9qVdtpOOdoZ6AG5b6D8q5hSaQ5ptJY+TAJxHP+GjTYGl8sVTdOiac9Q1iHEgBACQozkY4wLKT7nvhAjrHPYGGNQH08oqxqHskJ7Y9DaQAi5IBWk0uSFlOBCwFqLYRi+4L3HJl+maUIaBmIcR4QQ4bwnP40DxmAxRoeUBjjnKdv7/f6BeZ5pfpNTTSnRzpxzupdKoWcc2lgEq2Ded9DnEt4HMC6IbwOmhE3ORGoD4yPGGUjTjGEcKdMc3PkAGxLSONHC1T4Hy5bWgDcmcOwU0XBLG0iZayie/j5N+MkoYD5y3/c4HY8oiwLHuoZSigThfAnY94wEYZyDMUbvLzAqUxYkW1wDdl2PsqxwKEq8bHd4fT1gu91ht3/F35ctirIiMdYyfGR4luKZYc6oaVucTm9oz2eczxfqy7x7fIg2Pur645FJFKWgtH7UbDluzxhtpKgHl/7LPfvZsiAfRPEhwDsHrRTVq+s6ysxoDSkEnLX0LBO8J6+UfD77VpSbctgfGxSnFvv6HVVzxU0YXLlGJy2Rx72y6FakBdMO0kUIF2HiBB8fR67lgN/FG37tKvwp3rB/v1ILFW2P6spx6jXqm0R1FSgvy3htszw+tD1aFaA8BQywwwwVRsgHZpjh74Cbfia/59dxSNgYa+m7/Uz+c/wPtMZa/AN8uoKQP0ziWQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"13\" title=\"13\" src=\"/static/1e5c740e8db1951756a949dac298183e/fcda8/13.png\" srcset=\"/static/1e5c740e8db1951756a949dac298183e/12f09/13.png 148w,\n/static/1e5c740e8db1951756a949dac298183e/e4a3f/13.png 295w,\n/static/1e5c740e8db1951756a949dac298183e/fcda8/13.png 590w,\n/static/1e5c740e8db1951756a949dac298183e/bad1b/13.png 841w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>로컬에서 발급받은 pem(키페어) 파일이 있는 위치로 이동하여, 시키는 대로 입력한다.</p>\n<ol>\n<li><code class=\"language-text\">chmod</code>(change mode)로 나(첫 번째)에게만 4(read) 즉 ‘읽기’ 권한을 제공하고, (그룹/전체에는 권한이 없다.)</li>\n<li>public IP로 EC2 인스턴스에 접속한다.</li>\n</ol>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ chmod 400 KEY-zigsong-deploy-guidebook.pem\n$ ssh -i \"KEY-zigsong-deploy-guidebook.pem\" ubuntu@ec2-13-125-205-164.ap-northeast-2.compute.amazonaws.com</code></pre></div>\n<p>이때, 첫 접속 시 다음과 같은 에러가 발생할 수 있다. 원격지의 호스트를 로컬에 연결할 때 첫 번째로 자격을 증명하기 위한 과정이다. ‘yes’를 선택하여 쭉 넘어간다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a9015165303601543fd3287b1c110133/869d7/14.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 10.81081081081081%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgUlEQVQI1z2LQQrDIAAEzdUkIAg1UKPUtCYmsZJnFHot9NT//2JKPfSwzA7Lihhv2OuTU3hjwovz/GFKD2KcWNeNUgrHceC9ZxgGnHMYY2ofxxGtNX3fo5SqFDln0hLY0oUlOvY1kPeZnO/ULSWstfXQti1d1/0ppaz5edM0CCH4AqZeNZyo1jYaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"14\" title=\"14\" src=\"/static/a9015165303601543fd3287b1c110133/fcda8/14.png\" srcset=\"/static/a9015165303601543fd3287b1c110133/12f09/14.png 148w,\n/static/a9015165303601543fd3287b1c110133/e4a3f/14.png 295w,\n/static/a9015165303601543fd3287b1c110133/fcda8/14.png 590w,\n/static/a9015165303601543fd3287b1c110133/efc66/14.png 885w,\n/static/a9015165303601543fd3287b1c110133/c83ae/14.png 1180w,\n/static/a9015165303601543fd3287b1c110133/869d7/14.png 1477w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>정상적으로 실행되면 다음과 같이 원격지 호스트 컴퓨터인 EC2 인스턴스에 접속된다!</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bdb7fa0d7debb63a6fe83ffe3c533199/07d7d/15.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVQoz52SOW7EMAxFve+yJEsxLMn2eBw4ZY6QJkCK3P8+PyCz1NEUH5RYPC6fybZtsOENyn9AuXeY7RN6foUxGt57zPOMvu8hhEDXdfym+Ku2bf/y9E4IeNwWqLHE9ex/dMM0TUiSJF5SShhjMUqNQUjWRP9x5MrRwPM8cV0XlmVB0zTQWoNyxhjukgrmef5/IO2GILSDuq4ZWlUVd5dl2WMjH8fBos5CCFzAWsvQYRjiwGQKjbzvO9Z15VHJraIovl2L7dA7D+ccgg+8RypAoLIseQXRQKUV9KRBUSnFY5IJaZo+djbL5eBeHOz9Ceu+QQwCbdfyIZNBscAvBWbbfgNa7dMAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"15\" title=\"15\" src=\"/static/bdb7fa0d7debb63a6fe83ffe3c533199/fcda8/15.png\" srcset=\"/static/bdb7fa0d7debb63a6fe83ffe3c533199/12f09/15.png 148w,\n/static/bdb7fa0d7debb63a6fe83ffe3c533199/e4a3f/15.png 295w,\n/static/bdb7fa0d7debb63a6fe83ffe3c533199/fcda8/15.png 590w,\n/static/bdb7fa0d7debb63a6fe83ffe3c533199/efc66/15.png 885w,\n/static/bdb7fa0d7debb63a6fe83ffe3c533199/c83ae/15.png 1180w,\n/static/bdb7fa0d7debb63a6fe83ffe3c533199/07d7d/15.png 1478w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<hr>\n<h2 id=\"3-프로젝트-세팅\" style=\"position:relative;\"><a href=\"#3-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%B8%ED%8C%85\" aria-label=\"3 프로젝트 세팅 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 프로젝트 세팅</h2>\n<p>Next.js로 (정말로) 간단하게 만든 페이지를 github에 올려두었다. SSH로 EC2에 접속한 상태에서, 해당 repository를 clone한다.</p>\n<p>(내 레포를 클론해도 되겠지만, 간단한 라우팅 외에 아무것도 없으므로 아주 허탈할 것이다.)</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git clone https://github.com/zigsong/a11y-airline.git</code></pre></div>\n<p>우선 node를 설치해준다. <a href=\"https://docs.aws.amazon.com/ko_kr/sdk-for-javascript/v2/developer-guide/setting-up-node-on-ec2-instance.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">다음 링크</a>를 참조하여 설치를 진행했다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo apt-get update # 기본적인 업데이트 진행\n$ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash\n$ . ~/.nvm/nvm.sh\n$ nvm install node</code></pre></div>\n<blockquote>\n<p><strong>👾 apt-get vs yum</strong>\n크게 중요한 건 아닌 것 같지만, ssh에서 사용하는 명령어를 apt-get 방식으로 사용하는 곳도 있고, yum으로 사용하는 곳도 있다. 둘의 차이는 호스트가 RedHat 계열의 CentOS라면 yum을, Debian 계열의 Ubuntu라면 apt-get 방식을 사용하는 것이라고 한다. EC2 호스트 컴퓨터로 Ubuntu를 사용했기 때문에 되도록 apt-get 명령어를 사용했다.</p>\n<p>자세한 내용이 궁금하다면 아래 출처를 확인해 보자.\n<a href=\"https://www.lesstif.com/lpt/ubuntu-apt-apt-get-redhat-centos-yum-89555903.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ubuntu apt(apt-get)와 Redhat/CentOS yum 명령어 비교표</a> > <a href=\"https://coding-factory.tistory.com/318\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">리눅스란 무엇인가? (센토스 vs 우분투)</a></p>\n</blockquote>\n<p>아래 명령어로 node.js가 올바르게 설치되었는지 확인한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ node -e \"console.log('Running Node.js ' + process.version)\"</code></pre></div>\n<p>yarn을 설치하고,</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ curl -o- -L https://yarnpkg.com/install.sh | bash</code></pre></div>\n<p>프로젝트의 패키지들을 설치해준다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ yarn install</code></pre></div>\n<hr>\n<h2 id=\"4-nextjs-앱-custom-서버-설정\" style=\"position:relative;\"><a href=\"#4-nextjs-%EC%95%B1-custom-%EC%84%9C%EB%B2%84-%EC%84%A4%EC%A0%95\" aria-label=\"4 nextjs 앱 custom 서버 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. next.js 앱 custom 서버 설정</h2>\n<p><code class=\"language-text\">next start</code> 커맨드를 사용하면 vercel에서 제공하는 기본 서버를 사용할 수 있지만, 여기서는 EC2 인스턴스에서 따로 서버를 관리할 것이기 때문에 커스텀 서버를 만들어줄 것이다.\n(👾 <code class=\"language-text\">next start</code>만으로도 EC2 서버를 돌릴 수 있다고 한다! <a href=\"https://eminent-grill-3b7.notion.site/next-js-EC2-9e611603a8d34994a710efa40654078d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">크루 신세한탄의 글</a> 참고)</p>\n<p><a href=\"https://nextjs.org/docs/advanced-features/custom-server\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">next.js 공식문서</a>를 참고하여 다음과 같이 express 서버 코드를 작성해 주었다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// server.js</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 커스텀 서버를 next app과 연결시켜 준다.</span>\n<span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"next\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> dev <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"production\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">8080</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dev <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> handle <span class=\"token operator\">=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  server<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  server<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">extended</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  server<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"*\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  server<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Ready on port </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PORT</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>next.js 커스텀 서버에서 사용하는 포트 번호는 EC2 인스턴스의 보안 그룹에서 인바운드 규칙에 포함되어 있어야 한다. 우테코 루트 계정을 사용하는 현재 보안 그룹에 따로 손을 댈 수 없어서, 기존 보안 그룹에 있는 8080 포트를 사용했다. ‘원본’의 ‘0.0.0.0/0’은 모든 소스를 허용함을 의미한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3d0464e0b7b4690603189fdc4634305a/41d3b/16.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 101.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtUlEQVQ4y51UO2gVQRQdEEUs/BVCxMZf/KCNBBFMKqsELQRRaytBsJJoZyPaBCRYaqFoEAQLizQiCGJvnc8zouTt232f/c3uzu7M3iN39u3TmETIGzjszN2Z+zn3I9IsQ5IkKIoCZZFBaw0pq3OWZVBKQeU5kjS1//ib57mV89kYM4A2BiKKYrhe2ypNug5kHKPptCCTBL2ejyAIEYaRvZOmGbx2G2EUIQhDq5QNs4EaggVstd3pwut0rSVeRIR61fuNvmVZroHgkFuuB/a0VlYS2cvDQDA/G3kzzLIK0zS1HBWFHgiHwUAhZ9LpRVgNc6wGCk6k4MU5mqFCkNVGtuBhoTW6PR+O6yFJs4pDJnhYDjnDnBgGZ1zXNaX1//HPHXaM34tYSvR8H/zlBGVKVXtV1RUbYpkt5n6t8ZnrtD6rGkpBxHEMr92xXVEagyCM8fOXgzTjywbtjg8/iKGURpoVNnlSSjSbjm0G3feshuBuYA+ZN2NKFCoEEDOTFibvoeutAFAAjJVFscTycgOtlmvf6b/aT3BrMbQ29sH8F4XHL3I8e2swO2cw8zLDk+cRZuc0Zl4ZLPwokSuJ5cYKXM/7w3fdy9yXdgjkrFDj5gNAjADiFCBGAXGyv2ccAt7Mw0awsNhAy3XXJdAq5OJWeWkV3npIECcIuy4QdoxV2D5G2HmeIE4T3n3kgpNYXFrr4SBk7pLUjqTKw/tPCfsngCNThDNXgaNTwOFJwugVwsglwofPTGOMxaXvm3gYhnba1CHffkQQZ4E944S948Dui9V+3wRh2znC+0+VQhtya5OQmcO8IJuU69MEcYC5I4hjgDjOqGgQBwmvLYfSKnRdb32WuYjtcE25LDi7hMk7wI1pwrV76IOsoct3CV+/EVCmaDou/CBY7yG3TM8P+jNR1m3ex9bXb2xGyho1RnIAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"16\" title=\"16\" src=\"/static/3d0464e0b7b4690603189fdc4634305a/fcda8/16.png\" srcset=\"/static/3d0464e0b7b4690603189fdc4634305a/12f09/16.png 148w,\n/static/3d0464e0b7b4690603189fdc4634305a/e4a3f/16.png 295w,\n/static/3d0464e0b7b4690603189fdc4634305a/fcda8/16.png 590w,\n/static/3d0464e0b7b4690603189fdc4634305a/41d3b/16.png 774w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>ssh 내부에서 아까 clone 받은 프로젝트 레포지토리로 들어가서, <code class=\"language-text\">next build</code>를 통해 커스텀 서버에서 관리할 파일을 생성한다. 실행 결과는 다음과 같다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/9161f5fb38990d4818512bbd3d96af23/6da96/17.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcUlEQVQoz5VT7W6CQBBcQBAUCngHp9ZWJVDxAyGx6vs/2TS71rZpGrU/NlluL3OzMwPRyyuiOMZut0PTNFitVlL7/R5VVaHX64GIHi8zmUhjWRYcx4Ft21LcK6UQBAGiKMJoNII2WmY3AbVSyPP8z2FRFFBawXM9BE8Bgi6A1bduA4ZhiO12Kwx+D2ez2fdjPoEqAnl3Vk6SBOv1Gl3XyWo/h+PpGGVVwiYbFBCofgAwTVMBZCPKssRyuZQaDAeIniNE5vMR75OldQfQ931xdLPZCMu2bVHXNeI4lpXni7kY9rDLruuK+AzIMVksFlL9fh/GGHH6X7FhU5gJa5llmQCwEQwWRiGU1pdzrWEbA1IKVm4ku36ew0qSy1mWw3FdEIMdDgcBPJ1OOB6Poun5fBYJroHfty2Kusa2bbHpOuimgTq8w3tbwUlTEP8ALA0H97rWlRkbxTHi/vrNd9IkwWQ8BmeXtAZlGWgyRW84/Fr5A0+S/q9rKquuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"17\" title=\"17\" src=\"/static/9161f5fb38990d4818512bbd3d96af23/fcda8/17.png\" srcset=\"/static/9161f5fb38990d4818512bbd3d96af23/12f09/17.png 148w,\n/static/9161f5fb38990d4818512bbd3d96af23/e4a3f/17.png 295w,\n/static/9161f5fb38990d4818512bbd3d96af23/fcda8/17.png 590w,\n/static/9161f5fb38990d4818512bbd3d96af23/efc66/17.png 885w,\n/static/9161f5fb38990d4818512bbd3d96af23/6da96/17.png 922w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이제 <code class=\"language-text\">next start</code>로 서버를 실행해 준다. (모든 커맨드는 ssh 셸 안에서 이루어진다.)</p>\n<p>인스턴스의 퍼블릭 IP 주소 또는 퍼블릭 DNS에 포트 ‘:8000’을 붙여 접속하면 정상적으로 next.js 앱이 뜨는 것을 확인할 수 있다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e54b97af49151f86aa40db9c779ce19b/f291a/18.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20.945945945945947%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsElEQVQY02VPAWrEMAzr/395cHdrezS0TRzbiWONJBsMJhACy5bwsm07vtYVIQQcRxgaE0GuE7yv0HCgpohqDbVWmBk4ZwgzmhmKCDIRKBFyZizMAlUd7Ae/KOlC3F6o9wVXwV+k9xP384Hy2aC9dF/hlIa33IkQiUEso93dZ2ApiOcJE0YriqYytEM5z7kqTGXQ+20PjFlwiw22ETYD+zuVEiwTvBZ4a5PuPxv/0b1vei84XI99iAkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"18\" title=\"18\" src=\"/static/e54b97af49151f86aa40db9c779ce19b/fcda8/18.png\" srcset=\"/static/e54b97af49151f86aa40db9c779ce19b/12f09/18.png 148w,\n/static/e54b97af49151f86aa40db9c779ce19b/e4a3f/18.png 295w,\n/static/e54b97af49151f86aa40db9c779ce19b/fcda8/18.png 590w,\n/static/e54b97af49151f86aa40db9c779ce19b/efc66/18.png 885w,\n/static/e54b97af49151f86aa40db9c779ce19b/c83ae/18.png 1180w,\n/static/e54b97af49151f86aa40db9c779ce19b/f291a/18.png 2258w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p><strong>&#x3C;그렇게 탄생한 앱></strong>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/429ed637607b65e53c8028ab30fde843/7595a/19.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAnElEQVQY03WMUQ6CMBAFuf9lNDEeRBO9gQaUSqEFS2F3jGBFPnzJJJvZt5u1rSe/V1yN5WaaibysyQtDeSmwPmL9MFG5SO17rAu4bqANQt1G+q6jfhistWSigoqgCKDM0WWWjuBKQlOCPCcvMoKm7udC3yjZYpJMXSWOsD8Lm0Nke4zsTkIY1g8SKdmvXBcUUeXm+VI4GGXe/bt7AaWZOFQT/GJvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"19\" title=\"19\" src=\"/static/429ed637607b65e53c8028ab30fde843/fcda8/19.png\" srcset=\"/static/429ed637607b65e53c8028ab30fde843/12f09/19.png 148w,\n/static/429ed637607b65e53c8028ab30fde843/e4a3f/19.png 295w,\n/static/429ed637607b65e53c8028ab30fde843/fcda8/19.png 590w,\n/static/429ed637607b65e53c8028ab30fde843/efc66/19.png 885w,\n/static/429ed637607b65e53c8028ab30fde843/c83ae/19.png 1180w,\n/static/429ed637607b65e53c8028ab30fde843/7595a/19.png 3576w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span></p>\n<p>…앱이 아주 썰렁하다. 어쩔 수 없다.</p>\n<hr>\n<h2 id=\"5-pm2로-프로세스-관리\" style=\"position:relative;\"><a href=\"#5-pm2%EB%A1%9C-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EA%B4%80%EB%A6%AC\" aria-label=\"5 pm2로 프로세스 관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. pm2로 프로세스 관리</h2>\n<p>이렇게 열린 서버는 ssh 셸을 나가면 그대로 죽는다. 꽤나 허탈한 기분이다. node.js의 프로세스 매니저인 <strong>pm2</strong>를 사용하여 말로만 듣던, 엄청나게 멋져 보이던 ‘무중단 서비스’를 운영해 보자.</p>\n<p>node.js는 기본적으로 싱글 스레드만 지원한다. pm2는 cluster 기능을 제공하여 최대 16개의 프로세스를 동시에 실행할 수 있게 해준다. 또 shell을 꺼도 계속 프로세스가 돌아갈 수 있도록 지원하며, 프로세스를 관찰하고 있다가 프로세스가 종료되면 다시 실행해줄 수 있다.</p>\n<p>아래 명령어로 pm2를 설치해준다. (물론 여전히 ssh 셸에서, 우리의 next.js 앱 디렉토리 안에 있다.)</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ npm install pm2 -g</code></pre></div>\n<p>다음 명령어로 pm2가 관리할 새로운 프로세스를 실행한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ pm2 start server.js\n$ pm2 start server.js --name \"next\" # 프로세스 이름을 따로 지정하고 싶은 경우</code></pre></div>\n<p><code class=\"language-text\">pm2 list</code> 명령어로 현재 실행중인 프로세스들을 확인할 수 있다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/b1001/20.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 11.486486486486488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcUlEQVQI1z2LMRLCMAwEU8SRZBkj28wkKQL8/5PLOAXd3e3e4kfgZ0fDqdcbq4O6n3jvpOysIkgEKWeSGVutJFVW1f82s07fnUXcib3jrTCOA9FMjMH1/fBsDS8FmcdN0Iehr4LZ7NvNW+9Ea7cjZvwATu4tyvwpLicAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"20\" title=\"20\" src=\"/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/fcda8/20.png\" srcset=\"/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/12f09/20.png 148w,\n/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/e4a3f/20.png 295w,\n/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/fcda8/20.png 590w,\n/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/efc66/20.png 885w,\n/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/c83ae/20.png 1180w,\n/static/22e3ffbf88bcfbc8bc6a36fbcfc2544c/b1001/20.png 1380w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이것저것 만져보며 프로세스를 일시정지하거나, 삭제하거나, error 시 재가동해 보자.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ pm2 stop [id 또는 name]\n$ pm2 restart [id 또는 name]\n$ pm2 delete [id 또는 name]\n$ pm2 start [id 또는 name] --watch # 코드가 변경되면 프로세스를 재시작한다.</code></pre></div>\n<p>pm2가 프로세스를 관리하고 있기 때문에, (오류가 발생하지 않는 한) 셸을 꺼도 서버는 계속 가동 중이다! (돈도 계속 나간다! 오예!)</p>\n<blockquote>\n<p>이렇게 ssh에서 pm2로 프로세스를 관리하는 것은 foreground로 프로세스를 돌리는 것에 해당한다. foreground 실행은 명령을 하나씩 실행하므로 사용자가 입력한 명령이 실행되어 결과가 출력될 때까지 기다려야 한다.</p>\n<p>pm2에서 background로 프로세스를 돌린다면 다른 작업을 수행하면서 프로세스를 계속 유지시킬 수 있다. ssh에서 background로 서버를 실행시키고 싶다면 명령어의 마지막에 <code class=\"language-text\">&amp;</code>를 입력하면 된다. background 작업은 터미널을 종료해도 계속 유지된다. (종료를 위해서는 프로세스를 kill해야 한다.)</p>\n<p>pm2는 <strong>데몬(Daemon)</strong> 방식을 사용하여 프로세스를 background에서 실행한다.</p>\n</blockquote>\n<hr>\n<h2 id=\"6-nginx-설치\" style=\"position:relative;\"><a href=\"#6-nginx-%EC%84%A4%EC%B9%98\" aria-label=\"6 nginx 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. nginx 설치</h2>\n<p>nginx 동시접속 처리에 특화된 웹 서버 프로그램이다. 이벤트 드리븐(Event-Driven)의 비동기 처리 방식을 채택하여, 여러 개의 요청을 효율적으로 처리할 수 있다.</p>\n<blockquote>\n<p><strong>👾 웹 서버?</strong>\n웹 서버는 HTML, CSS, JavaScript, 이미지와 같은 정보를 웹 브라우저에 전송하는 역할을 한다.\n(🍀<a href=\"https://zigsong.github.io/2021/09/12/web-server-was/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">참고 - Web Server와 WAS</a>)</p>\n</blockquote>\n<p>여기서는 nginx를 <strong>리버스 프록시(reverse proxy)</strong> 를 위해 사용할 것이다. 클라이언트가 가짜 서버에 요청을 보내면, 프록시 서버가 오리진 서버로부터 데이터를 가져오는 역할을 한다. 이때 nginx는 프록시 서버의 역할을 한다.</p>\n<blockquote>\n<p><strong>👾 프록시?</strong>\n프록시 서버는 클라이언트가 자신을 통해서 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해 주는 컴퓨터 시스템이나 응용 프로그램을 가리킨다. 서버와 클라이언트 사이에서 중계 기능을 하며, 대리로 통신을 수행하는 서버이다. 프록시는 일반적으로 <strong>포워드 프록시(forward proxy)</strong> 와 <strong>리버스 프록시(reverse proxy)</strong> 로 구분된다.</p>\n<p>포워드 프록시는 실제 서버 대신 클라이언트의 요청을 받아 결과를 클라이언트에 전달하는 역할을 한다. 사용자가 google.com에 연결하려고 하면 포워드 프록시 서버가 요청을 받아서 google.com에 연결하여 그 결과를 클라이언트에 전달해주는 것이다. 이때 포워드 프록시는 캐시를 사용하여 성능 향상에 기여한다.</p>\n<p>리버스 프록시는 클라이언트가 데이터 요청 시 요청을 받아 내부 서버에서 데이터를 받은 후 클라이언트에 전달한다. 클라이언트는 내부 서버에 대한 정보를 알 필요 없이 리버스 프록시에만 요청을 보낸다. 리버스 프록시는 로드 밸런싱 등의 기능을 제공하기도 한다.</p>\n<p>👩‍🏫 포워드 프록시는 ‘클라이언트’를 감추는 역할, 리버스 프록시는 ‘서버’를 감추는 역할을 한다.</p>\n</blockquote>\n<p>앞 단계까지 정상적으로 진행해왔다면, EC2에서 제공한 IP 주소의 지정해준 포트(여기서는 8080)로만 접속이 가능하다. 그러나 매번 이렇게 특정한 포트 번호까지 붙여 접속하긴 여간 귀찮은 일이 아니다.</p>\n<p>또 우리의 express 서버(next.js 앱의 커스텀 서버)가 어떤 포트로 열렸든 간에, 끝단의 사용자는 해당 정보를 알 필요가 없다. 웹 사이트의 기본 포트인 80포트(생략 가능)로 접속하기만 하면 될 뿐이다. nginx 웹 서버를 이용하여 8080 포트로 들어온 요청을 80포트로 전환시켜주고, 그 중간 과정은 숨겨줄 수 있다.</p>\n<blockquote>\n<p>즉, 외부에서 기본 포트인 80포트로 접속해도 리벅스 프록시 역할을 해주는 nginx가 express 서버로 <strong>proxy forwarding</strong>을 해준다.</p>\n</blockquote>\n<p>nginx를 설치하고, 서버를 시작한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo apt-get install nginx\n$ sudo service nginx start</code></pre></div>\n<p>아래 명령어를 통해 nginx가 설치된 경로를 확인할 수 있다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo find / -name nginx.conf</code></pre></div>\n<p>nginx가 정상적으로 구동되고 있는지 확인해 보자.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ps -ef | grep nginx</code></pre></div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/30518f24437cb744395cf117f5d4b6d0/d326d/21.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 7.4324324324324325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAATUlEQVQI1wXBQQqAIBRAwZaF+iVxIRqUVkogbez+V3vNTPdbiSVy9otUNlrriHhCiHxjMI6dp1ZyKeSUEGPwRmOXmdU5tNaICNZalFL8MMsZ/wIUsQQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"21\" title=\"21\" src=\"/static/30518f24437cb744395cf117f5d4b6d0/fcda8/21.png\" srcset=\"/static/30518f24437cb744395cf117f5d4b6d0/12f09/21.png 148w,\n/static/30518f24437cb744395cf117f5d4b6d0/e4a3f/21.png 295w,\n/static/30518f24437cb744395cf117f5d4b6d0/fcda8/21.png 590w,\n/static/30518f24437cb744395cf117f5d4b6d0/efc66/21.png 885w,\n/static/30518f24437cb744395cf117f5d4b6d0/c83ae/21.png 1180w,\n/static/30518f24437cb744395cf117f5d4b6d0/d326d/21.png 1197w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>현재 EC2 인스턴스의 기본 포트(80, 또는 생략 가능)으로 접속하면 아래와 같은 화면이 나타난다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 352px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/0f8f3109d276097bae07c263f5a56843/ba1c3/22.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 40.54054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABSUlEQVQY022Ry26DMBBF+f8PySbrbCOkJCqpwKYOjwilUeQUDH5gGxMCooSq0EXV5qxmRnM1V3es0+m0WCxs295sNuv12nEc13UBAEEQrFarl4m2bcdxfPzDKsvStu39fu+67na79TwvngjDcLlcQggRQsMwjM+w2rbVE0IIKaUQQinFORdCaK3nCeccY3y5XNI0vV4/zu9nQohSypJSAgCiKIrjGEIYBAEAAEIYRVGSJBDCOD52XWeMqaqqbur6ZrRWVVXd73fLGEMpzbKMMVYUBSEEY8wYo5RObZaRVAhOKdVal7mRxa3W3Y9tIcThcEAIhWHoeZ7v+0mSAAB3ux16Q76ToNfkiM7zNZFXPK90efuWPkaraRqMMeecMZbnOSGkKArO+Rxv3w2f/fh4ntdo9X3PGCvLUiklpZzdaq3/7P160Hc9i78AiAS0DSkgOVYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"22\" title=\"22\" src=\"/static/0f8f3109d276097bae07c263f5a56843/ba1c3/22.png\" srcset=\"/static/0f8f3109d276097bae07c263f5a56843/12f09/22.png 148w,\n/static/0f8f3109d276097bae07c263f5a56843/e4a3f/22.png 295w,\n/static/0f8f3109d276097bae07c263f5a56843/ba1c3/22.png 352w\" sizes=\"(max-width: 352px) 100vw, 352px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>nginx를 정상적으로 설치했다면, 기본 포트에 우리의 next.js 앱을 띄워주도록 설정을 수정해줘야 한다. nginx의 config를 설정하는 방법을 찾다가, 구글 검색 결과 최상단에 위치한 블로그를 많이 참고했다. 그런데 그 글이 우리 놀토 팀원 <a href=\"https://velog.io/@new_wisdom/AWS-EC2%EC%97%90-Node.jsExpress-pm2-nginx-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">아마찌의 포스트</a>였다니 😮</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ cd /etc/nginx/sites-available # 기본적으로 default 파일이 있다.\n$ sudo rm default\n$ sudo nano default</code></pre></div>\n<p>sites-available 디렉토리는, 가상 서버 환경들에 대한 설정 파일들이 위치하는 곳이다. nano 텍스트 에디터로 기본 default 파일을 삭제 후 새로 작성해 준다. (사실 nano 에디터 쓰는 법을 몰라서 vi 편집기로 수정했다.)</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">server {\n  listen 80;\n  listen [::]:80;\n\n  access_log /var/log/nginx/reverse-access.log;\n  error_log /var/log/nginx/reverse-error.log;\n\n  location / {\n    proxy_pass http://127.0.0.1:8080; # 현재 사용 중인 포트 번호\n  }\n}</code></pre></div>\n<blockquote>\n<p>default 파일의 모든 문장의 끝에 세미콜론(;)을 붙여줘야 정상적으로 동작한다</p>\n</blockquote>\n<p>config 파일이 정상적으로 입력이 되었는지 확인해 보자</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo nginx -t</code></pre></div>\n<blockquote>\n<p>👾 nginx.conf를 직접 수정해주는 방식도 있지만, 어차피 nginx.conf가 nginx/sites-available의 내용을 포함하고 있기 때문에 둘 중 무엇을 수정하든 상관없다. (sites-available에 있는 파일들이 sites-enabled에 symlink로 연결되어 있고, nginx.conf는 sites-enabled에 있는 파일들을 포함한다.)</p>\n</blockquote>\n<p>참고로 nginx 서버에서 80포트를 사용하므로, EC2 인스턴스의 인바운드 규칙 역시 80포트를 포함하고 있어야 한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3d0464e0b7b4690603189fdc4634305a/41d3b/23.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 101.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtUlEQVQ4y51UO2gVQRQdEEUs/BVCxMZf/KCNBBFMKqsELQRRaytBsJJoZyPaBCRYaqFoEAQLizQiCGJvnc8zouTt232f/c3uzu7M3iN39u3TmETIGzjszN2Z+zn3I9IsQ5IkKIoCZZFBaw0pq3OWZVBKQeU5kjS1//ib57mV89kYM4A2BiKKYrhe2ypNug5kHKPptCCTBL2ejyAIEYaRvZOmGbx2G2EUIQhDq5QNs4EaggVstd3pwut0rSVeRIR61fuNvmVZroHgkFuuB/a0VlYS2cvDQDA/G3kzzLIK0zS1HBWFHgiHwUAhZ9LpRVgNc6wGCk6k4MU5mqFCkNVGtuBhoTW6PR+O6yFJs4pDJnhYDjnDnBgGZ1zXNaX1//HPHXaM34tYSvR8H/zlBGVKVXtV1RUbYpkt5n6t8ZnrtD6rGkpBxHEMr92xXVEagyCM8fOXgzTjywbtjg8/iKGURpoVNnlSSjSbjm0G3feshuBuYA+ZN2NKFCoEEDOTFibvoeutAFAAjJVFscTycgOtlmvf6b/aT3BrMbQ29sH8F4XHL3I8e2swO2cw8zLDk+cRZuc0Zl4ZLPwokSuJ5cYKXM/7w3fdy9yXdgjkrFDj5gNAjADiFCBGAXGyv2ccAt7Mw0awsNhAy3XXJdAq5OJWeWkV3npIECcIuy4QdoxV2D5G2HmeIE4T3n3kgpNYXFrr4SBk7pLUjqTKw/tPCfsngCNThDNXgaNTwOFJwugVwsglwofPTGOMxaXvm3gYhnba1CHffkQQZ4E944S948Dui9V+3wRh2znC+0+VQhtya5OQmcO8IJuU69MEcYC5I4hjgDjOqGgQBwmvLYfSKnRdb32WuYjtcE25LDi7hMk7wI1pwrV76IOsoct3CV+/EVCmaDou/CBY7yG3TM8P+jNR1m3ex9bXb2xGyho1RnIAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"23\" title=\"23\" src=\"/static/3d0464e0b7b4690603189fdc4634305a/fcda8/23.png\" srcset=\"/static/3d0464e0b7b4690603189fdc4634305a/12f09/23.png 148w,\n/static/3d0464e0b7b4690603189fdc4634305a/e4a3f/23.png 295w,\n/static/3d0464e0b7b4690603189fdc4634305a/fcda8/23.png 590w,\n/static/3d0464e0b7b4690603189fdc4634305a/41d3b/23.png 774w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이제 EC2 퍼블릭 IP의 기본 포트로 앱 접속이 가능하다!</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bcfe4474bc39f6817c9db40f2f3fee72/c0b43/24.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 18.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAnElEQVQY022OywrCQAxF+/+/5N69uimKgq2dGZmXM0OVCuaIWvEZOIHc3EtSWedpjUYZgzZ7OqXptMGrjtBsCW1DUAofE9YHfIg4HzjkTMqFXAqnknHOkVKiQgTht2TswzHRl8i5j/dZ5MGPf9QrGdNP4cblHhAW6sKkHpiuByb1mZV9hj/97weq78XLIGw8zDUsLcw07A7y8eU/riZaNqfF4L/dAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"24\" title=\"24\" src=\"/static/bcfe4474bc39f6817c9db40f2f3fee72/fcda8/24.png\" srcset=\"/static/bcfe4474bc39f6817c9db40f2f3fee72/12f09/24.png 148w,\n/static/bcfe4474bc39f6817c9db40f2f3fee72/e4a3f/24.png 295w,\n/static/bcfe4474bc39f6817c9db40f2f3fee72/fcda8/24.png 590w,\n/static/bcfe4474bc39f6817c9db40f2f3fee72/efc66/24.png 885w,\n/static/bcfe4474bc39f6817c9db40f2f3fee72/c83ae/24.png 1180w,\n/static/bcfe4474bc39f6817c9db40f2f3fee72/c0b43/24.png 1793w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<hr>\n<h2 id=\"7-도메인-설정-및-https-연결\" style=\"position:relative;\"><a href=\"#7-%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%84%A4%EC%A0%95-%EB%B0%8F-https-%EC%97%B0%EA%B2%B0\" aria-label=\"7 도메인 설정 및 https 연결 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. 도메인 설정 및 https 연결</h2>\n<p>하지만 뭔가 아쉽다. 기본 포트인 80포트로의 연결은 동작하지만, 113.~ 으로 시작하는 못생긴 IP 주소를 누가 외우고 다닐까!</p>\n<p>나만의 도메인을 등록해보자. <del>미션에까지 돈을 쓰고 싶진 않기 때문에</del> <a href=\"https://xn--220b31d95hq8o.xn--3e0b707e/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">내도메인 한국</a> 사이트에서 괜찮은 주소를 찾았다. EC2에서 제공하는 Public IP 주소만 연결해주면 된다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/2cb77f2597ec0c51ace91f2eaef3cf6c/0f7d5/25.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfElEQVQ4y42T228TRxSH95/loaqo1AKikCYRAgohgBAUKiAIeOCJlz4hQaAFJASJxEXQpshKcOx11ru2936Z2RnbH5pxcCwEgpE+nd+5zUV71tFpRvzvez683aK76fFqfR3f7zJZ4z07HjFdRs/6tm5S6/zzZI0ffjrG4skr7D94mn0/LnBk8Tynz61wcO4sPx9eYvHkZX4/e50DR87wy69nOLF0leNLV3f9JY6d+tPGr928i/P8zTanrj3ijzvPWF55xPKNvzl/6ynLNx5z9MJ95i7c57eLD5i/uGq1Yd76D6b+wqVVDi3f4/ZfL3GKIqcXBBib55llONRorXbRE9SM/jxntFIMh0Ocsixpt9skSYpSirquKYoCKWtGoxFSSuubuNFfwuTMxrXS5oYFzWaTMAwRQlBVFeYQo80BpsHob21oLiDrGscEPM8jzbJpc57nVpsnfC/K3lDhmF27nkcSR9TmtBmkFEjxHezWmRc5lefiv3tN6W4jOq1dZvUecmePz3NVp0XdbuJEG//TWFun8FzyHRfhe5TdDqofQBqhBgH9rQaZ26Lu+ciga6n7ga2Z4DNME+rGBo5KY9z/3uFvNpCDHmXQJWo1qXo+5KmNBVsNS9TeJnZbJJ22zYt+gOj7yEGAjiNk2MeRSrHtdojSFKEUpZTEaUZVK/srSa0JBgN6YUgpJEJpW2fyxhZC2B49hkqPJl/ZDHaWpZRFRZ6XZEmCqEqGWtkxisLQkiQJZVFQVSVVOUNVTUfIzuHq6kPW117gdgs6gaaQmlxoCqHtcH9aRn8NMzrGOmYo3U6HXi8gTAuivCYuFFGuSCsN4zFRFBHH8bTp64z5CPdFVV4KxHogAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"25\" title=\"25\" src=\"/static/2cb77f2597ec0c51ace91f2eaef3cf6c/fcda8/25.png\" srcset=\"/static/2cb77f2597ec0c51ace91f2eaef3cf6c/12f09/25.png 148w,\n/static/2cb77f2597ec0c51ace91f2eaef3cf6c/e4a3f/25.png 295w,\n/static/2cb77f2597ec0c51ace91f2eaef3cf6c/fcda8/25.png 590w,\n/static/2cb77f2597ec0c51ace91f2eaef3cf6c/efc66/25.png 885w,\n/static/2cb77f2597ec0c51ace91f2eaef3cf6c/0f7d5/25.png 993w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>여전히 별거없지만, 이제 나름 도메인이라고 붙인 주소로 접속할 수 있다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c48cc37e9484d485094c776950dceed7/e1250/26.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 19.594594594594593%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAlUlEQVQY03WO2wrCMBBE+///4ov9EtGCVHz3mru1tUmOJKmFig4cWGZ2J6k6rZCHPZe2QR9bpDYIIRGycJcaoUwmz5OvtMG5B8Y6eufQSiGVpIoxQiYAkaTkZT/JdwxO8DQ3YJjzb31uKqaamRyUJdvDauOpdy/W24G6CfTjsmDxOJQf/iLVjz5ysnB1hbMFH0r27+4NwYo3gsnsXs8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"26\" title=\"26\" src=\"/static/c48cc37e9484d485094c776950dceed7/fcda8/26.png\" srcset=\"/static/c48cc37e9484d485094c776950dceed7/12f09/26.png 148w,\n/static/c48cc37e9484d485094c776950dceed7/e4a3f/26.png 295w,\n/static/c48cc37e9484d485094c776950dceed7/fcda8/26.png 590w,\n/static/c48cc37e9484d485094c776950dceed7/efc66/26.png 885w,\n/static/c48cc37e9484d485094c776950dceed7/c83ae/26.png 1180w,\n/static/c48cc37e9484d485094c776950dceed7/e1250/26.png 1786w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>그런데 아무래도 저 ‘주의 요함’ 문구가 마음에 들지 않는다. HTTPS를 붙여 보안 설정을 강화해보도록 하자.</p>\n<p>크루 <a href=\"https://github.com/Puterism/infra-deploy-book/blob/cheffe/deploy-next-js-with-ec2.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">체프☕️의 가이드북</a>의 도움을 받았다.</p>\n<p>nginx의 site-available 파일에 다시 들어가서 HTTPS 접속을 원하는 서버의 이름을 <code class=\"language-text\">server_name</code>으로 추가해준다. (위에서 생성한 도메인을 붙이면 된다.)</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 506px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f55cad88e40c33e504b990e2189a87bb/29f4e/27.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 43.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaklEQVQoz6WSW2vbQBCFdbduq92VLcmWZBTHIbWtC41baOu4NKShUPr/f89XsklbQh/ykIfDDGeHD+bsWF3XsdlskFJiWdbbZdu2aRzHQWYZSiniKCJNU9IkMV727GulEEKgpCQTwvRaa+I4Nu+u6/4D+mHEOE30w2B06HujYZz4cjpxez5zczyameOHj+z7gWmaGB5nDwf6vsf3fSznGXgTOTwUKV9VxEMl+ZbH3BeCu3nCz3bBj5XmeyG4LyW/VopPhSSVklkQkOc5YRi+XPmUepRNS9k06LJifblFLgrq7oKiblBFSaI0siixLYvRfSXDU+LyXqdMuWDSCQcRsk9nvIt9dknAdeiyDWy2M4edbzF6rwAzz+H2cs3d7orzVcfni5ax0FxnsdFei7+1zwVLmRHGMXVdv7yQP0Db87Ac98n0A6p2zaJuzOqPEeTLFbpaPtWyYlk3LOZz8ylt2/4PDALfBPzWO/wNyN/UKIvIpMAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"27\" title=\"27\" src=\"/static/f55cad88e40c33e504b990e2189a87bb/29f4e/27.png\" srcset=\"/static/f55cad88e40c33e504b990e2189a87bb/12f09/27.png 148w,\n/static/f55cad88e40c33e504b990e2189a87bb/e4a3f/27.png 295w,\n/static/f55cad88e40c33e504b990e2189a87bb/29f4e/27.png 506w\" sizes=\"(max-width: 506px) 100vw, 506px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>Certbot을 설치한다.</p>\n<blockquote>\n<p><strong>👾 Certbot?</strong>\nLet’s Encrypt 인증서를 사용하여 자동으로 HTTPS를 활성화하는 무료 오픈 소스 소프트웨어 도구이다.</p>\n</blockquote>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo apt-get install python3-certbot-nginx</code></pre></div>\n<p>다음 명령어로 인증서 발급을 시작한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo certbot --nginx</code></pre></div>\n<p>이메일 작성, 약관 동의를 한 후 HTTPS 설정을 할 도메인을 입력한다. (다른 설정을 만지다가 한번 꼬여서 이 화면은 캡쳐하지 못했다 😵)</p>\n<p>그러면 다음과 같은 2가지 선택지 중 선택하라고 나온다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/d2215f4c4aa8a9c94ecc8272b5709893/612f7/28.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB70lEQVQoz1WSaW7bMBSEZTdeRC3ULmulNku146Cpg8RN2qIH6P3P8xVk0gL9MZiZh+FQImn9anJudc5bW3Crcr6rki+J5LlMeS5S458OMc9Fwo+u4ppHvJQptyrjrS3N/BK4vGQhgRBY1/rAcV5QdUVTVUzDgGpqLucTvVI83N9zyFKmoee0LMbrzHI8cv68MHQKPwwZxQZhWViv88i4LDR1Tdd1KKVQbcv5fGYYBvq+N7jo4sOBOI7J0pQoikjTlKosibIMtb/DXVlYX3tFVFaUTUPd9WRFSdE0BmGSkpWV0WWrzELb81hvt4a9IGS7t7HWnzhsVni68Pdp5HFQvEw9177lqW+5do3Rj6rmsa24VAejb/PI6zLxUBdG/7yc+DaPDGnEcmfhrS2sQboo6dIHHq0nDHfSNRhCn8533lm6jKH/Tw8fOZ2f4oDGtVnpM9S/2fQD3TShxpEgSbBdD+H5CF+ydz0cX7ITjvGOlGyFMHMNnXWDkI0tsHRhICVSSsIgIIljHEdg2zaOEDiOY+ZBEBCFIa7joPO+5xl2XRdh2+9Ff6Fvqq5r8jw3SJKEqqoMiqIwNyk+yne7ndlsv98b1n6z2fxfqJ/GNE3M82xYP53j8Wi8Rtu2ZiNdXpal0fqLdakuWK1WrNdrw7rwDxb9/S/1HuKlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"28\" title=\"28\" src=\"/static/d2215f4c4aa8a9c94ecc8272b5709893/fcda8/28.png\" srcset=\"/static/d2215f4c4aa8a9c94ecc8272b5709893/12f09/28.png 148w,\n/static/d2215f4c4aa8a9c94ecc8272b5709893/e4a3f/28.png 295w,\n/static/d2215f4c4aa8a9c94ecc8272b5709893/fcda8/28.png 590w,\n/static/d2215f4c4aa8a9c94ecc8272b5709893/612f7/28.png 773w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>HTTP로 접속했을 때, HTTPS로 자동 리다이렉트되도록 설정할 것인지 묻는 옵션이다. 2번을 선택하면 Certbot에서 nginx 설정을 알아서 바꿔준다. <del>따로 설정하기 머리 아프기 때문에</del> 2번을 선택한다.</p>\n<p>마지막으로 인증서가 만료되기 전에 알아서 갱신되도록 Crontab을 설정할 것이다. 먼저 Crontab 설정 파일을 연다. 설정 파일을 열 때 편한 편집기를 고르라는 메시지가 뜨는데, 편한 편집기로 고르면 된다.</p>\n<blockquote>\n<p><strong>👾 Crontab이란?</strong>\n리눅스의 작업 예약 스케줄러로, 특정 시간에 특정 작업을 할 수 있게 해주는 도구다.</p>\n</blockquote>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo crontab -e</code></pre></div>\n<p>최하단에 다음 설정을 추가한다. 이렇게 설정하면 매월 1일 오후 6시마다 인증서를 갱신하고 nginx를 재시작하는 명령어가 실행된다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ 0 18 1 * * certbot renew --renew-hook=\"sudo service restart nginx\"</code></pre></div>\n<p>그럼 진짜 설정 끝!</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e9e7717a64ec22a8d819997c94e859c4/1ac66/29.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 45.94594594594595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYElEQVQoz12S2ZKCQAxFUVFxx31HBbRcAS0t3yz//6fu1MmUM+pDKiRNbk7S7dzvdz2fT6VpqsfjoX6/r3w+r0KhINd1VSwWP/y7lUollctls1wuJ8dx5NRqNR2PR+12O/Pr9VrL5VKLxUJRFCmOY4VhqCAI7Gyz2VgOPxwONRqNDIKGJuh5ntHt93tdr1dlWWbx5XL5i1erlRqNhgaDgYngMRP4NnDfiSiGgBxkNCKGBErIyCNYqVTUbDatCTomSBIaxqUQAQiJIaQJMeOez2c7Z++cJ0mi2+1m8el0Ur1e/xWk66s7BRBMJhOLIcW2263m87na7ba63a5arZY6nY5831e1Wv3fIYKIgc24FCHESBBzhsdoMp1O7RJ6vZ4JfoyLocyP7Ihus9nMKLh9KCggz7NADLrxeGzf1CFODTFPzW75cDjYjrgYKFk0h7wzxsFjjM0/rylYDx5B/uMt/gDyEekUBsTu4gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"29\" title=\"29\" src=\"/static/e9e7717a64ec22a8d819997c94e859c4/fcda8/29.png\" srcset=\"/static/e9e7717a64ec22a8d819997c94e859c4/12f09/29.png 148w,\n/static/e9e7717a64ec22a8d819997c94e859c4/e4a3f/29.png 295w,\n/static/e9e7717a64ec22a8d819997c94e859c4/fcda8/29.png 590w,\n/static/e9e7717a64ec22a8d819997c94e859c4/1ac66/29.png 651w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<p>이제 HTTPS로 접속할 수 있다. ‘주의 요함’ 대신 자물쇠 아이콘이 걸려있다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/392b188a05eeb0ab265a4cb02d8cc3ca/ec2ae/30.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 18.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAlElEQVQY03WNuw6CQBRE9///SQt7C2NhEB+FBQS4C7srKpjcY8JTjU4y1ZyZMdkxJj3F2DzHVo5ChMLawSVSusmFWMSWXeZ8oPKecK15BI+I4JzDACjKKFXt3OvJPQg3L7R1NeXozPf9uWf0x9DIry/KMmpYHRoWUcvZDvc6898H5j34gFD2OWxT2GWwSSDxOgz+9wujwTcV2kFWYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"30\" title=\"30\" src=\"/static/392b188a05eeb0ab265a4cb02d8cc3ca/fcda8/30.png\" srcset=\"/static/392b188a05eeb0ab265a4cb02d8cc3ca/12f09/30.png 148w,\n/static/392b188a05eeb0ab265a4cb02d8cc3ca/e4a3f/30.png 295w,\n/static/392b188a05eeb0ab265a4cb02d8cc3ca/fcda8/30.png 590w,\n/static/392b188a05eeb0ab265a4cb02d8cc3ca/efc66/30.png 885w,\n/static/392b188a05eeb0ab265a4cb02d8cc3ca/c83ae/30.png 1180w,\n/static/392b188a05eeb0ab265a4cb02d8cc3ca/ec2ae/30.png 3572w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<hr>\n<h2 id=\"요약\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요약</h2>\n<ol>\n<li>AWS EC2 인스턴스 생성</li>\n<li>SSH 접속</li>\n<li>git clone, node, yarn 설치</li>\n<li>next.js 커스텀 서버 설정</li>\n<li>pm2로 프로세스 관리</li>\n<li>nginx로 리버스 프록시 설정</li>\n<li>도메인 설정 및 https 연결</li>\n</ol>\n<p>어마어마한 과정이었다 😵</p>\n<hr>\n<p><strong>Ref</strong></p>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/what-is-amazon-vpc.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/what-is-amazon-vpc.html</a></li>\n<li><a href=\"https://medium.com/harrythegreat/aws-%EA%B0%80%EC%9E%A5%EC%89%BD%EA%B2%8C-vpc-%EA%B0%9C%EB%85%90%EC%9E%A1%EA%B8%B0-71eef95a7098\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://medium.com/harrythegreat/aws-가장쉽게-vpc-개념잡기-71eef95a7098</a></li>\n<li><a href=\"https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/using-instance-addressing.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/using-instance-addressing.html</a></li>\n<li><a href=\"https://docs.aws.amazon.com/ko_kr/quicksight/latest/user/vpc-security-groups.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.aws.amazon.com/ko_kr/quicksight/latest/user/vpc-security-groups.html</a></li>\n<li><a href=\"https://aws.amazon.com/ko/about-aws/whats-new/2021/08/amazon-ec2-customers-ed25519-keys-authentication/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://aws.amazon.com/ko/about-aws/whats-new/2021/08/amazon-ec2-customers-ed25519-keys-authentication/</a></li>\n<li><a href=\"https://2ham-s.tistory.com/349\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://2ham-s.tistory.com/349</a></li>\n<li><a href=\"https://velog.io/@hojin9622/PM2-%EC%A0%95%EB%A6%AC\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://velog.io/@hojin9622/PM2-정리</a></li>\n<li><a href=\"https://twpower.github.io/50-make-nginx-virtual-servers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://twpower.github.io/50-make-nginx-virtual-servers</a></li>\n<li><a href=\"https://bcp0109.tistory.com/194\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://bcp0109.tistory.com/194</a></li>\n<li><a href=\"https://www.lesstif.com/system-admin/forward-proxy-reverse-proxy-21430345.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.lesstif.com/system-admin/forward-proxy-reverse-proxy-21430345.html</a></li>\n</ul>","timeToRead":17,"frontmatter":{"title":"EC2로 Next.js 앱 배포하기","date":"October 02, 2021","description":null,"tags":["aws","next"],"disqus":null},"fields":{"langKey":"en"}}},"pageContext":{"slug":"/frontend/ec2-next/","previous":{"fields":{"slug":"/frontend/ssr-without-next/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"October 02, 2021","description":null,"title":"Next.js 없이 React 앱 SSR 적용하기","tags":["react"]}},"next":{"fields":{"slug":"/react/react-as-ui-runtime/","langKey":"en","directoryName":"react"},"frontmatter":{"date":"September 26, 2021","description":null,"title":"UI runtime으로서의 리액트","tags":["react"]}},"previousInSameTag":null,"nextInSameTag":{"fields":{"slug":"/frontend/s3-cloudfront/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"August 28, 2021","description":null,"title":"React App s3 & Cloudfront로 배포하기","tags":["aws","frontend"]}},"translationsLink":[]}},"staticQueryHashes":["1522010811","2466007692","2894998521","3765107650","683610688"]}