{"componentChunkName":"component---src-templates-blog-post-js","path":"/react/await-setstate/","result":{"data":{"site":{"siteMetadata":{"title":"ziglog","author":"zigsong","lang":"en"}},"markdownRemark":{"id":"06af4924-bdc5-51e4-9458-7c64a77f7c02","excerpt":"Reactì˜ setStateì— awaitâ€¦","html":"<p>Reactì˜ setStateì— awaitì„ ë¶™ì´ë©´?</p>\n<!-- more -->\n<hr>\n<p>í•œë²ˆë„ ìƒê°í•´ë³¸ ì  ì—†ì—ˆëŠ”ë°, í˜ì–´ ë¯¸í‚¤ê°€ ì–´ëŠ íšŒì‚¬ğŸ¥• ë©´ì ‘ì„ ë³´ê³ ì˜¨ í›„ ë‚˜ì˜¨ ì§ˆë¬¸ì¸ë° ì‹ ê¸°í•˜ë‹¤ë©° ì•Œë ¤ì¤€ ë‚´ìš©. <code class=\"language-text\">setState</code>ì— <code class=\"language-text\">await</code>ì„ ë¶™ì´ë©´ <code class=\"language-text\">setState</code>ê°€ ë™ê¸°ì ìœ¼ë¡œ ë™ì‘í•œë‹¤? ğŸ¤”</p>\n<p>ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ëŠ” ì¼ë°˜ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ í˜¸ì¶œì˜ ë‚´ë¶€ì—ì„œ ë™ì‘í•˜ëŠ” <code class=\"language-text\">setState</code> ë©”ì„œë“œë“¤ì„ ëª¨ë‘ ëª¨ì•„ í•œë²ˆì— ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜í–‰í•œë‹¤(batch). ì´ëŠ” ë Œë”ë§ íšŸìˆ˜ë¥¼ ì¤„ì—¬ ìµœì í™”ë¥¼ ìœ„í•œ ê²ƒì´ë‹¤. ê·¸ë¦¬ê³  ë§Œì•½ <code class=\"language-text\">setState</code>ê°€ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì—ì„œ ì²« ë²ˆì§¸ <code class=\"language-text\">setState</code> í˜¸ì¶œì´ ë°”ë¡œ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜í–‰í•œë‹¤ë©´, ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë˜ì–´ ë‹¤ìŒ ì¤„ì˜ <code class=\"language-text\">setState</code>ëŠ” ì‹¤í–‰ë˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.</p>\n<p>ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ ê°™ì€ <code class=\"language-text\">state</code>ë¥¼ ì°¸ì¡°í•˜ëŠ” <code class=\"language-text\">setState</code>ë¥¼ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•˜ë©´ ì›í•˜ëŠ” ëŒ€ë¡œ ê°’ì´ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠëŠ”ë‹¤. <code class=\"language-text\">setState</code>ì˜ ë™ê¸°ì ì¸ ë¦¬ì•¡íŠ¸ì—ì„œ <code class=\"language-text\">state</code>ì˜ ì—…ë°ì´íŠ¸ê°€ ë¹„ë™ê¸°ì ì¼ ìˆ˜ ìˆë‹¤ê³  í•˜ëŠ” ì´ìœ ë‹¤.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">decrease</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">increase</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>count<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>btn-group<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">decrease</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">-</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">RESET</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">increase</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">+</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<img src=\"/48749dbd2475222285da956c9ac94355/01.gif\">\n<p><code class=\"language-text\">decrease</code>ì™€ <code class=\"language-text\">increase</code>ì—ì„œ ë°œìƒí•˜ëŠ” 3ë²ˆì˜ <code class=\"language-text\">setState</code> í˜¸ì¶œë“¤ì€ ëª¨ë‘ ì—…ë°ì´íŠ¸ ì´ì „ì˜ ë™ì¼í•œ <code class=\"language-text\">count</code> ê°’ì„ ì°¸ì¡°í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, 3ì”© ì»¤ì§€ê±°ë‚˜ ì‘ì•„ì§€ì§€ ì•ŠëŠ”ë‹¤.</p>\n<p>ê·¸ëŸ°ë° <code class=\"language-text\">setState</code> ì•ì— <code class=\"language-text\">await</code>ì„ ë¶™ì¸ë‹¤ê³  í•œë“¤ ë­ê°€ ë ê¹Œ?</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function-variable function\">increase</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// decreaseë„ ë§ˆì°¬ê°€ì§€</span></code></pre></div>\n<p>ì •ë§ ë ê¹Œ?</p>\n<img src=\"/20aee91f45136e67db838d6fa3593c8f/02.gif\">\n<p>ì§„ì§œ ëœë‹¤! ğŸ˜® í•œë²ˆì— 3ì”© ê°’ì´ ë°”ë€ë‹¤.</p>\n<p>ë™ì‘í•˜ëŠ” ì´ìœ ë¥¼ ë¯¸í‚¤ì™€ í•¨ê»˜ ì˜ë…¼í•´ ë³´ì•˜ë‹¤. (ì‚¬ì‹¤ ê±°ì˜ ë¯¸í‚¤ì˜ ìƒê°ë“¤ì´ë‹¤! ì •ë¦¬í•´ë†¨ì§€ë§Œ í™•ì‹¤í•˜ê²ŒëŠ” ì˜ ëª¨ë¥´ê² ë‹¤.)</p>\n<p>ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ <code class=\"language-text\">async-await</code>ì€ ë°”ë²¨ì— ì˜í•´ generator í•¨ìˆ˜ë¡œ ë°”ë€Œê²Œ ëœë‹¤. (<a href=\"https://zigsong.github.io/2021/09/05/babel-almost/#%F0%9F%A4%94-%EC%B6%94%EA%B0%80-Babel%EC%97%90%EC%84%9C-Promise%EB%A5%BC-%EC%B2%98%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EC%8B%9D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ë¸”ë¡œê·¸ ì´ì „ í¬ìŠ¤íŒ… ì°¸ê³ </a>) generator í•¨ìˆ˜ëŠ” <code class=\"language-text\">yield</code>ë¥¼ ì‚¬ìš©í•˜ëŠ”ë°, <code class=\"language-text\">yield</code>ëŠ” ì‹¤í–‰ ê¶Œí•œì„ ì œë„ˆë ˆì´í„° í•¨ìˆ˜ì˜ í˜¸ì¶œìì—ê²Œ ë„˜ê¸´ë‹¤. ë”°ë¼ì„œ í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ì˜ ë Œë”ë§ ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ë‘ ë²ˆì§¸, ì„¸ ë²ˆì§¸ <code class=\"language-text\">setState</code>ì˜ ì—°ì†ì ì¸ í˜¸ì¶œì€ ë…ë¦½ì ìœ¼ë¡œ ì‘ë™í•˜ê²Œ ëœë‹¤. <code class=\"language-text\">setState</code>ê°€ <code class=\"language-text\">async-await</code>ë¡œ ì‘ë™í•˜ëŠ” ê²ƒâ€ì²˜ëŸ¼â€ ë³´ì´ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.</p>\n<blockquote>\n<p>ğŸ‘¾ ì´ ë†€ë¼ìš´(?) ë™ì‘ì€ í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ê°€ëŠ¥í•˜ë‹¤! í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì˜ <code class=\"language-text\">useState</code> hookì—ì„œëŠ” stale closure ë¬¸ì œê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>\n</blockquote>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Counter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">increase</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// const decrease = async () => ...</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">useState</code>ëŠ” ë§¤ë²ˆ ìƒˆë¡œìš´ í´ë¡œì €ë¥¼ ìƒì„±í•œë‹¤. ë‚´ë¶€ êµ¬í˜„ì€ ì•„ë˜ ì½”ë“œì™€ ê°™ì€ ëŠë‚Œ? (ì½”ë“œ ì¶œì²˜: <a href=\"https://github.com/woowacourse/javascript-own-ui-library/pull/7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ì§€ê·¸ì˜ Virtual DOM ë¯¸ì…˜</a>ì„ ë³€í˜•)</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> React <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// stale closure</span>\n  <span class=\"token keyword\">let</span> _value<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">useState</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">initialValue</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    _value <span class=\"token operator\">=</span> _value <span class=\"token operator\">||</span> initialValue<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">setState</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">newValue</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      _value <span class=\"token operator\">=</span> newValue<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>getState<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ê° <code class=\"language-text\">setState</code> í˜¸ì¶œì— <code class=\"language-text\">await</code>ì„ ë¶™ì˜€ë‹¤í•œë“¤, <code class=\"language-text\">count</code>ëŠ” ì—¬ì „íˆ í˜„ì¬ ë Œë”ë§ëœ ì»´í¬ë„ŒíŠ¸ì—ì„œ ëª¨ë‘ ê¸°ì¡´ì˜ ê°’ì„ ì°¸ì¡°í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì¦‰ê°ì ì¸ ìƒíƒœì˜ ì—…ë°ì´íŠ¸ë¥¼ ë°˜ì˜í•˜ì§€ ëª»í•œë‹¤.</p>\n<p><code class=\"language-text\">await</code>ì„ ì‚¬ìš©í•œ <code class=\"language-text\">setState</code> í˜¸ì¶œì€ ê²°êµ­ ì•„ë˜ì™€ ê°™ì´ <code class=\"language-text\">Promise</code>ë¥¼ ì‚¬ìš©í•œ <code class=\"language-text\">then</code> ì²´ì´ë‹ìœ¼ë¡œ í•´ì„ë  ìˆ˜ ìˆë‹¤.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">increase</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">then</code> ì²´ì´ë‹ì˜ ì½œë°±ìœ¼ë¡œ ë“¤ì–´ê°„ <code class=\"language-text\">setCount</code> í˜¸ì¶œ í•¨ìˆ˜ëŠ” ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì— ë‹´ê¸´ë‹¤. ì´ ë¹„ë™ê¸° ì½œë°±ë“¤ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ í™˜ê²½ì—ì„œ ì½œìŠ¤íƒì´ ëª¨ë‘ ë¹ˆ í›„ì— í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì—, ê²°ë¡ ì ìœ¼ë¡œ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì˜ ë Œë”ë§ ì´í›„ì— ë™ì‘í•œë‹¤. ì´ë•Œ <code class=\"language-text\">then</code> ì²´ì´ë‹ ë‚´ì˜ ì½œë°±ë“¤ì´ ê°€ë¦¬í‚¤ëŠ” <code class=\"language-text\">count</code> ê°’ì€ <code class=\"language-text\">+1</code>ë¡œ ê°±ì‹ ëœ ê°’ì´ ì•„ë‹Œ, í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ ê°€ì¥ ì´ˆê¸°ì˜ ê°’ì„ ê·¸ëŒ€ë¡œ ê°€ì§€ê³  ìˆë‹¤.</p>\n<p>í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ëŠ” ë Œë”ë§ë  ë•Œë§ˆë‹¤ ë§¤ë²ˆ ì¬ìƒì„±ë˜ê¸° ë•Œë¬¸ì— stale closure ë¬¸ì œê°€ ë°œìƒí•˜ì§€ë§Œ, í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ì˜ ê²½ìš°ì—ëŠ” í•œ ë²ˆ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— <code class=\"language-text\">await</code>ì„ ë¶™ì¸ <code class=\"language-text\">setState</code>ì˜ ë™ê¸°ì  ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë‹¤.</p>\n<p>í•˜ì§€ë§Œ ì–´ì¨Œë“  ê°„ì—, <code class=\"language-text\">setState</code> í•¨ìˆ˜ëŠ” Promiseë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— <code class=\"language-text\">await</code>ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì¢‹ì§€ ì•Šë‹¤. êµ³ì´ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function-variable function\">updateState</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"updated\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function-variable function\">decrease</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<hr>\n<p><strong>Ref</strong>\n<a href=\"https://muscardinus.tistory.com/196\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://muscardinus.tistory.com/196</a>\n<a href=\"https://hewonjeong.github.io/deep-dive-how-do-react-hooks-really-work-ko/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://hewonjeong.github.io/deep-dive-how-do-react-hooks-really-work-ko/</a></p>","timeToRead":4,"frontmatter":{"title":"Reactì˜ setStateì— awaitì„ ë¶™ì´ë©´?","date":"October 16, 2021","description":null,"tags":["react"],"disqus":null},"fields":{"langKey":"en"}}},"pageContext":{"slug":"/react/await-setstate/","previous":{"fields":{"slug":"/frontend/refresh-token/","langKey":"en","directoryName":"frontend"},"frontmatter":{"date":"October 16, 2021","description":null,"title":"ë¡œê·¸ì¸ì— refreshToken ì ìš©í•˜ê¸°","tags":["frontend"]}},"next":{"fields":{"slug":"/wtc/wtc-week-34/","langKey":"en","directoryName":"wtc"},"frontmatter":{"date":"October 09, 2021","description":null,"title":"ìš°í…Œì½” 34ì£¼ì°¨ ê¸°ë¡","tags":["woowacourse"]}},"previousInSameTag":{"fields":{"slug":"/react/react-function-class-component/","langKey":"en","directoryName":"react"},"frontmatter":{"date":"November 16, 2021","description":null,"title":"ë¦¬ì•¡íŠ¸ê°€ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì™€ í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬ë³„í•˜ëŠ” ë²•","tags":["react"]}},"nextInSameTag":{"fields":{"slug":"/react/react-18/","langKey":"en","directoryName":"react"},"frontmatter":{"date":"October 03, 2021","description":null,"title":"React 18 í†ºì•„ë³´ê¸°","tags":["react"]}},"translationsLink":[]}},"staticQueryHashes":["1522010811","1615650028","2894998521","3765107650","683610688"]}