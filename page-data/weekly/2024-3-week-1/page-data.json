{"componentChunkName":"component---src-templates-blog-post-js","path":"/weekly/2024-3-week-1/","result":{"data":{"site":{"siteMetadata":{"title":"ziglog","author":"zigsong","lang":"en"}},"markdownRemark":{"id":"bd6024a0-91b7-5a1e-82b3-84f647cd3e64","excerpt":"배워가기 상태관리 매니저로서 React Query “React Query is in fact NOT a data fetching library.” An Async State Manager 리액트 쿼리는 비동기 상태를 다룬다 querykey는 unique한 query…","html":"<h2 id=\"배워가기\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EC%9B%8C%EA%B0%80%EA%B8%B0\" aria-label=\"배워가기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배워가기</h2>\n<h3 id=\"상태관리-매니저로서-react-query\" style=\"position:relative;\"><a href=\"#%EC%83%81%ED%83%9C%EA%B4%80%EB%A6%AC-%EB%A7%A4%EB%8B%88%EC%A0%80%EB%A1%9C%EC%84%9C-react-query\" aria-label=\"상태관리 매니저로서 react query permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>상태관리 매니저로서 React Query</h3>\n<blockquote>\n<p>“React Query is in fact <em>NOT</em> a data fetching library.”</p>\n</blockquote>\n<ul>\n<li>\n<p><strong>An Async State Manager</strong></p>\n<ul>\n<li>리액트 쿼리는 비동기 상태를 다룬다</li>\n<li>querykey는 unique한 query를 구분해주며, 이를 통해 앱의 여러 곳에서 같은 key로 같은 query를 사용할 수 있다 (같은 <code class=\"language-text\">QueryClientProvider</code> 에 있기만 한다면)</li>\n</ul>\n</li>\n<li>\n<p><strong>A data synchronization tool</strong></p>\n<ul>\n<li>리액트 쿼리는 비동기 상태를 다루기 때문에 프론트엔드 앱이 데이터를 ‘가지지’ 않게끔 해준다</li>\n<li>리액트 쿼리는 우리의 화면을 실제 데이터 소유자와 동기화시키는 방법(서버를 이용해) 제공한다</li>\n</ul>\n</li>\n<li>\n<p><strong>Before React Query</strong></p>\n<ul>\n<li>한번 fetch하고, 전역으로 뿌리고, 드물게 업데이트한다\n<ul>\n<li>ex) redux</li>\n</ul>\n</li>\n<li>매 mount마다 fetch하고, 로컬 상태로 갖고 있는다\n<ul>\n<li>ex) useEffect</li>\n</ul>\n</li>\n</ul>\n<p>→ 두 가지 모두 최적화가 되어있지 않다</p>\n</li>\n<li>\n<p><strong>Stale While Revalidate</strong></p>\n<ul>\n<li>리액트 쿼리는 데이터를 캐싱하여 필요할 때 건네준다.</li>\n<li>stale data가 no data보다 낫다는 가정(로딩 스피너를 보여주지 않아도 된다)</li>\n<li>동시에 background refetch를 수행한다</li>\n</ul>\n</li>\n<li>\n<p><strong>Smart refetches</strong></p>\n<ul>\n<li>매 렌더링마다 <code class=\"language-text\">useQuery</code>를 호출하는 것은 너무 비싼 작업. 리액트 쿼리는 보다 똑똑하게 동작한다\n<ul>\n<li><code class=\"language-text\">refetchOnMount</code></li>\n<li><code class=\"language-text\">refetchOnWindowFocus</code></li>\n<li><code class=\"language-text\">refeetchOnReconnect</code></li>\n</ul>\n</li>\n<li>수동으로 invalidation도 가능 - <code class=\"language-text\">queryClient.invalidateQueries</code></li>\n</ul>\n</li>\n<li>\n<p><strong>Letting React Query do its magic</strong></p>\n<ul>\n<li><code class=\"language-text\">staleTime</code>의 기본값은 0이므로, 새로운 컴포넌트가 마운트될 때마다 background refetch된다. 그러면 같은 렌더 사이클에 있지 않아 넘 많은 fetch가 발생할 텐데…?</li>\n<li>(뭔 소리지?) - 밑에서 알려주려나 보다</li>\n</ul>\n</li>\n<li>\n<p><strong>Customize <em>staleTime</em></strong></p>\n<ul>\n<li>데이터가 신선한 한, 항상 캐시에서 가져온다.</li>\n</ul>\n</li>\n<li>\n<p><strong>Bonus: using setQueryDefaults</strong></p>\n<ul>\n<li>\n<p><a href=\"https://react-query.tanstack.com/reference/QueryClient#queryclientsetquerydefaults\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">QueryClient.setQueryDefaults</a>로 query key에 기본값을 설정할 수 있다</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// 🚀 everything todo-related will have</span>\n<span class=\"token comment\">// a 1 minute staleTime</span>\nqueryClient<span class=\"token punctuation\">.</span><span class=\"token function\">setQueryDefaults</span><span class=\"token punctuation\">(</span>\n  todoKeys<span class=\"token punctuation\">.</span>all<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> staleTime<span class=\"token operator\">:</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>A note on separation of concerns</strong></p>\n<ul>\n<li>관심사의 분리\n<ul>\n<li><code class=\"language-text\">useContext</code>, <code class=\"language-text\">useQuery</code>, <code class=\"language-text\">useSelector</code> 등의 등장으로 ui와 데이터 페칭의 분리가 가능해짐</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><strong>Ref</strong> <a href=\"https://tkdodo.eu/blog/react-query-as-a-state-manager\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React Query as a State Manager</a></p>\n<h3 id=\"packagejson의-bin은-뭘까\" style=\"position:relative;\"><a href=\"#packagejson%EC%9D%98-bin%EC%9D%80-%EB%AD%98%EA%B9%8C\" aria-label=\"packagejson의 bin은 뭘까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>package.json의 <code class=\"language-text\">bin</code>은 뭘까?</h3>\n<p>실행할 수 있는 패키지를 만들기 위해서는 package.json에 <code class=\"language-text\">bin</code> 항목을 제공해야 한다. 패키지 설치 시에, npm은 <code class=\"language-text\">bin</code> 항목에 기술된 파일의 심볼릭 링크를 global install한 경우 <code class=\"language-text\">prefix/bin</code>에, local install한 경우 <code class=\"language-text\">./node_modules/.bin/</code> 에 생서하게 된다</p>\n<p>ex) myapp이 아래와 같이 <code class=\"language-text\">bin</code> 항목이 지정되어 있다면</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token string-property property\">\"bin\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">\"myapp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./cli.js\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>myapp을 설치할 때, cli.js 파일에 대한 심볼릭 링크가 <code class=\"language-text\">/usr/local/bin/myapp</code>에 만들어진다</p>\n<p>만약 하나의 실행 파일만 가지고 있다면, 실행 파일의 이름은 패키지의 이름과 같게 되고, 그렇지 않다면 아래와 같이 각각의 실행 파일의 이름을 <code class=\"language-text\">bin</code> 항목에 지정해주어야 한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token string-property property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my-program\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.2.5\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"bin\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"my-program\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./path/to/program\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Ref</strong></p>\n<ul>\n<li><a href=\"https://programmingsummaries.tistory.com/385\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://programmingsummaries.tistory.com/385</a></li>\n<li><a href=\"https://docs.npmjs.com/cli/v10/configuring-npm/package-json#bin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.npmjs.com/cli/v10/configuring-npm/package-json#bin</a></li>\n</ul>\n<h3 id=\"웹컴포넌트-custom-element-라이프사이클-콜백\" style=\"position:relative;\"><a href=\"#%EC%9B%B9%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-custom-element-%EB%9D%BC%EC%9D%B4%ED%94%84%EC%82%AC%EC%9D%B4%ED%81%B4-%EC%BD%9C%EB%B0%B1\" aria-label=\"웹컴포넌트 custom element 라이프사이클 콜백 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>웹컴포넌트 custom element 라이프사이클 콜백</h3>\n<ul>\n<li><strong>connectedCallback()</strong>\n<ul>\n<li>custom element가 문서에 연결된 요소에 추가될 때마다 호출</li>\n</ul>\n</li>\n<li><strong>disconnectedCallback()</strong>\n<ul>\n<li>custom element가 document의 DOM에서 연결 해제되었을 때마다 호출</li>\n</ul>\n</li>\n<li><strong>adoptedCallback()</strong>\n<ul>\n<li>custom element가 새로운 document로 이동되었을 때마다 호출</li>\n</ul>\n</li>\n<li><strong>attributeChangedCallback()</strong>\n<ul>\n<li>custom element의 특성들 중 하나가 추가되거나, 제거되거나, 변경될 때마다 호출</li>\n<li>어떤 특성이 변경에 대해 알릴지는 static get observedAttributes 메서드에서 명시</li>\n</ul>\n</li>\n</ul>\n<p><strong>Ref</strong> &#x3C;<a href=\"https://developer.mozilla.org/ko/docs/Web/API/Web_components/Using_custom_elements#%EC%83%9D%EB%AA%85_%EC%A3%BC%EA%B8%B0_%EC%BD%9C%EB%B0%B1_%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://developer.mozilla.org/ko/docs/Web/API/Web_components/Using_custom_elements#생명_주기_콜백_사용하기</a></p>\n<hr>\n<h2 id=\"이것저것-모음집\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EA%B2%83%EC%A0%80%EA%B2%83-%EB%AA%A8%EC%9D%8C%EC%A7%91\" aria-label=\"이것저것 모음집 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이것저것 모음집</h2>\n<hr>\n<p>없음</p>\n<h2 id=\"기타공유\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%ED%83%80%EA%B3%B5%EC%9C%A0\" aria-label=\"기타공유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기타공유</h2>\n<hr>\n<h3 id=\"inpinteraction-to-next-paint\" style=\"position:relative;\"><a href=\"#inpinteraction-to-next-paint\" aria-label=\"inpinteraction to next paint permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>INP(Interaction to Next Paint)</h3>\n<p>크롬 Web Vital에서 3월 12일부터 FID(First Input Delay)를 대체하게 될 INP(Interaction to Next Paint) 메트릭에 대한 소개글.</p>\n<p>페이지 수명 동안 페이지와의 모든 클릭, 탭, 키보드 상호작용의 지연 시간을 관찰 후 이상점을 무시하고 가장 긴 기간이 측정된다고 한다.</p>\n<p>근데 FID와 다른 의미 아닌가? …싶었는데 그에 대한 <a href=\"https://web.dev/blog/inp-cwv-march-12?hl=ko\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">해명(?)</a>도 있다.</p>\n<blockquote>\n<p>최초 입력 반응 시간 (FID)은 프로그램의 반응성 측면을 나타내지만, 시간이 지남에 따라 FID가 아닌 웹에서의 상호작용 측면을 캡처하려면 새로운 측정항목이 필요하다는 사실이 분명해졌습니다.</p>\n</blockquote>\n<p>아무튼, INP라니 MBTI 유형 같다.</p>\n<p><strong>Ref</strong> <a href=\"https://web.dev/articles/inp?hl=ko\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://web.dev/articles/inp?hl=ko</a></p>\n<h2 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h2>\n<hr>\n<p>대체 혼자 자면 잠을 못 이루는 바보탱 🤷‍♀️</p>\n<p>취미생활 하나 홀딩했다고 갑자기 생겨버린 무한한 시간에 무한한(?) 여유를 즐기고 있당. 좋구만</p>","timeToRead":5,"frontmatter":{"title":"3월 첫주차 기록","date":"March 09, 2024","description":"잠을 왜 못 자니","tags":["weekly"],"disqus":null},"fields":{"langKey":"en"}}},"pageContext":{"slug":"/weekly/2024-3-week-1/","previous":{"fields":{"slug":"/weekly/2024-3-week-2/","langKey":"en","directoryName":"weekly"},"frontmatter":{"date":"March 16, 2024","description":"봄기운 물씬 🌸","title":"3월 2주차 기록","tags":["weekly"]}},"next":{"fields":{"slug":"/weekly/2024-2-week-5/","langKey":"en","directoryName":"weekly"},"frontmatter":{"date":"March 02, 2024","description":"공연 끝!","title":"2월 5주차 기록","tags":["weekly"]}},"previousInSameTag":{"fields":{"slug":"/weekly/2024-3-week-2/","langKey":"en","directoryName":"weekly"},"frontmatter":{"date":"March 16, 2024","description":"봄기운 물씬 🌸","title":"3월 2주차 기록","tags":["weekly"]}},"nextInSameTag":{"fields":{"slug":"/weekly/2024-2-week-5/","langKey":"en","directoryName":"weekly"},"frontmatter":{"date":"March 02, 2024","description":"공연 끝!","title":"2월 5주차 기록","tags":["weekly"]}},"translationsLink":[]}},"staticQueryHashes":["1522010811","2466007692","2894998521","3765107650","683610688"]}